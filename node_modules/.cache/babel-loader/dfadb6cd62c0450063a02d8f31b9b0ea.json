{"ast":null,"code":"import _slicedToArray from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _objectWithoutProperties from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nvar _excluded = [\"radius\", \"width\", \"height\", \"front\", \"back\", \"steer\", \"force\", \"maxBrake\"];\n\nvar _jsxFileName = \"C:\\\\Users\\\\Alex\\\\Desktop\\\\car\\\\src\\\\Vehicle.js\",\n    _s = $RefreshSig$();\n\nimport { useRef } from 'react';\nimport { useFrame } from '@react-three/fiber';\nimport { useRaycastVehicle } from '@react-three/cannon';\nimport { useControls } from './utils/useControls';\nimport Beetle from './Beetle';\nimport Wheel from './Wheel';\nimport { Camera } from 'three';\nimport { Vector3 } from 'three';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Vehicle(_ref) {\n  _s();\n\n  var _ref$radius = _ref.radius,\n      radius = _ref$radius === void 0 ? 0.7 : _ref$radius,\n      _ref$width = _ref.width,\n      width = _ref$width === void 0 ? 1.2 : _ref$width,\n      _ref$height = _ref.height,\n      height = _ref$height === void 0 ? -0.04 : _ref$height,\n      _ref$front = _ref.front,\n      front = _ref$front === void 0 ? 1.3 : _ref$front,\n      _ref$back = _ref.back,\n      back = _ref$back === void 0 ? -1.15 : _ref$back,\n      _ref$steer = _ref.steer,\n      steer = _ref$steer === void 0 ? 0.75 : _ref$steer,\n      _ref$force = _ref.force,\n      force = _ref$force === void 0 ? 2000 : _ref$force,\n      _ref$maxBrake = _ref.maxBrake,\n      maxBrake = _ref$maxBrake === void 0 ? 1e5 : _ref$maxBrake,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  var chassis = useRef();\n  var wheel1 = useRef();\n  var wheel2 = useRef();\n  var wheel3 = useRef();\n  var wheel4 = useRef();\n  var controls = useControls();\n  var wheelInfo = {\n    radius: radius,\n    directionLocal: [0, -1, 0],\n    suspensionStiffness: 30,\n    suspensionRestLength: 0.3,\n    maxSuspensionForce: 1e4,\n    maxSuspensionTravel: 0.3,\n    dampingRelaxation: 10,\n    dampingCompression: 4.4,\n    axleLocal: [-1, 0, 0],\n    chassisConnectionPointLocal: [1, 0, 1],\n    useCustomSlidingRotationalSpeed: true,\n    customSlidingRotationalSpeed: -30,\n    frictionSlip: 2\n  };\n\n  var wheelInfo1 = _objectSpread(_objectSpread({}, wheelInfo), {}, {\n    isFrontWheel: true,\n    chassisConnectionPointLocal: [-width / 2, height, front]\n  });\n\n  var wheelInfo2 = _objectSpread(_objectSpread({}, wheelInfo), {}, {\n    isFrontWheel: true,\n    chassisConnectionPointLocal: [width / 2, height, front]\n  });\n\n  var wheelInfo3 = _objectSpread(_objectSpread({}, wheelInfo), {}, {\n    isFrontWheel: false,\n    chassisConnectionPointLocal: [-width / 2, height, back]\n  });\n\n  var wheelInfo4 = _objectSpread(_objectSpread({}, wheelInfo), {}, {\n    isFrontWheel: false,\n    chassisConnectionPointLocal: [width / 2, height, back]\n  });\n\n  var _useRaycastVehicle = useRaycastVehicle(function () {\n    return {\n      chassisBody: chassis,\n      wheels: [wheel1, wheel2, wheel3, wheel4],\n      wheelInfos: [wheelInfo1, wheelInfo2, wheelInfo3, wheelInfo4],\n      indexForwardAxis: 2,\n      indexRightAxis: 0,\n      indexUpAxis: 1\n    };\n  }),\n      _useRaycastVehicle2 = _slicedToArray(_useRaycastVehicle, 2),\n      vehicle = _useRaycastVehicle2[0],\n      api = _useRaycastVehicle2[1];\n\n  useFrame(function (state) {\n    var _controls$current = controls.current,\n        forward = _controls$current.forward,\n        backward = _controls$current.backward,\n        left = _controls$current.left,\n        right = _controls$current.right,\n        brake = _controls$current.brake,\n        reset = _controls$current.reset;\n\n    for (var e = 2; e < 4; e++) {\n      api.applyEngineForce(forward || backward ? force * (forward && !backward ? -1 : 1) : 0, 2);\n    }\n\n    for (var s = 0; s < 2; s++) {\n      api.setSteeringValue(left || right ? steer * (left && !right ? 1 : -1) : 0, s);\n    }\n\n    for (var b = 2; b < 4; b++) {\n      api.setBrake(brake ? maxBrake : 0, b);\n    }\n\n    if (reset) {\n      chassis.current.api.position.set(0, 0.5, 0);\n      chassis.current.api.velocity.set(0, 0, 0);\n      chassis.current.api.angularVelocity.set(0, 0.5, 0);\n      chassis.current.api.rotation.set(0, -Math.PI / 4, 0);\n    }\n\n    state.camera.lookAt(chassis.current.position); //state.camera.position.set(chassis.current.position[0], chassis.current.position[1] + 5, chassis.current.position[2] + 15)\n\n    console.log(chassis.current.position);\n    state.camera.updateProjectionMatrix();\n  });\n  return /*#__PURE__*/_jsxDEV(\"group\", {\n    ref: vehicle,\n    position: [0, -0.4, 0],\n    rotation: [0, 0, 0],\n    children: [/*#__PURE__*/_jsxDEV(Beetle, {\n      ref: chassis,\n      rotation: props.rotation,\n      position: props.position,\n      angularVelocity: props.angularVelocity\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Wheel, {\n      ref: wheel1,\n      radius: radius,\n      leftSide: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Wheel, {\n      ref: wheel2,\n      radius: radius\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Wheel, {\n      ref: wheel3,\n      radius: radius,\n      leftSide: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Wheel, {\n      ref: wheel4,\n      radius: radius\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Vehicle, \"reIzH8+yPd/+nlRzBUR0Ms6/BGs=\", false, function () {\n  return [useControls, useRaycastVehicle, useFrame];\n});\n\n_c = Vehicle;\nexport default Vehicle;\n\nvar _c;\n\n$RefreshReg$(_c, \"Vehicle\");","map":{"version":3,"names":["useRef","useFrame","useRaycastVehicle","useControls","Beetle","Wheel","Camera","Vector3","Vehicle","radius","width","height","front","back","steer","force","maxBrake","props","chassis","wheel1","wheel2","wheel3","wheel4","controls","wheelInfo","directionLocal","suspensionStiffness","suspensionRestLength","maxSuspensionForce","maxSuspensionTravel","dampingRelaxation","dampingCompression","axleLocal","chassisConnectionPointLocal","useCustomSlidingRotationalSpeed","customSlidingRotationalSpeed","frictionSlip","wheelInfo1","isFrontWheel","wheelInfo2","wheelInfo3","wheelInfo4","chassisBody","wheels","wheelInfos","indexForwardAxis","indexRightAxis","indexUpAxis","vehicle","api","state","current","forward","backward","left","right","brake","reset","e","applyEngineForce","s","setSteeringValue","b","setBrake","position","set","velocity","angularVelocity","rotation","Math","PI","camera","lookAt","console","log","updateProjectionMatrix"],"sources":["C:/Users/Alex/Desktop/car/src/Vehicle.js"],"sourcesContent":["import { useRef } from 'react'\r\nimport { useFrame } from '@react-three/fiber'\r\nimport { useRaycastVehicle } from '@react-three/cannon'\r\nimport { useControls } from './utils/useControls'\r\nimport Beetle from './Beetle'\r\nimport Wheel from './Wheel'\r\nimport { Camera } from 'three'\r\nimport { Vector3 } from 'three'\r\n\r\nfunction Vehicle({ radius = 0.7, width = 1.2, height = -0.04, front = 1.3, back = -1.15, steer = 0.75, force = 2000, maxBrake = 1e5, ...props }) {\r\n  const chassis = useRef()\r\n  const wheel1 = useRef()\r\n  const wheel2 = useRef()\r\n  const wheel3 = useRef()\r\n  const wheel4 = useRef()\r\n  const controls = useControls()\r\n\r\n\r\n  const wheelInfo = {\r\n    radius,\r\n    directionLocal: [0, -1, 0],\r\n    suspensionStiffness: 30,\r\n    suspensionRestLength: 0.3,\r\n    maxSuspensionForce: 1e4,\r\n    maxSuspensionTravel: 0.3,\r\n    dampingRelaxation: 10,\r\n    dampingCompression: 4.4,\r\n    axleLocal: [-1, 0, 0],\r\n    chassisConnectionPointLocal: [1, 0, 1],\r\n    useCustomSlidingRotationalSpeed: true,\r\n    customSlidingRotationalSpeed: -30,\r\n    frictionSlip: 2\r\n  }\r\n\r\n  const wheelInfo1 = { ...wheelInfo, isFrontWheel: true, chassisConnectionPointLocal: [-width / 2, height, front] }\r\n  const wheelInfo2 = { ...wheelInfo, isFrontWheel: true, chassisConnectionPointLocal: [width / 2, height, front] }\r\n  const wheelInfo3 = { ...wheelInfo, isFrontWheel: false, chassisConnectionPointLocal: [-width / 2, height, back] }\r\n  const wheelInfo4 = { ...wheelInfo, isFrontWheel: false, chassisConnectionPointLocal: [width / 2, height, back] }\r\n\r\n  const [vehicle, api] = useRaycastVehicle(() => ({\r\n    chassisBody: chassis,\r\n    wheels: [wheel1, wheel2, wheel3, wheel4],\r\n    wheelInfos: [wheelInfo1, wheelInfo2, wheelInfo3, wheelInfo4],\r\n    indexForwardAxis: 2,\r\n    indexRightAxis: 0,\r\n    indexUpAxis: 1\r\n  }))\r\n\r\n  useFrame((state) => {\r\n    const { forward, backward, left, right, brake, reset } = controls.current\r\n    for (let e = 2; e < 4; e++) api.applyEngineForce(forward || backward ? force * (forward && !backward ? -1 : 1) : 0, 2) \r\n    for (let s = 0; s < 2; s++) api.setSteeringValue(left || right ? steer * (left && !right ? 1 : -1) : 0, s)\r\n    for (let b = 2; b < 4; b++) api.setBrake(brake ? maxBrake : 0, b)\r\n    if (reset) {\r\n      chassis.current.api.position.set(0, 0.5, 0)\r\n      chassis.current.api.velocity.set(0, 0, 0)\r\n      chassis.current.api.angularVelocity.set(0, 0.5, 0)\r\n      chassis.current.api.rotation.set(0, -Math.PI / 4, 0)\r\n    }\r\n  \r\n      \r\n     \r\n      state.camera.lookAt(chassis.current.position)\r\n      //state.camera.position.set(chassis.current.position[0], chassis.current.position[1] + 5, chassis.current.position[2] + 15)\r\n      console.log(chassis.current.position)\r\n      state.camera.updateProjectionMatrix()\r\n\r\n  })\r\n\r\n  return (\r\n    <group ref={vehicle} position={[0, -0.4, 0]} rotation={[0, 0, 0]}>\r\n      <Beetle ref={chassis} rotation={props.rotation} position={props.position} angularVelocity={props.angularVelocity} />\r\n      <Wheel ref={wheel1} radius={radius} leftSide />\r\n      <Wheel ref={wheel2} radius={radius} />\r\n      <Wheel ref={wheel3} radius={radius} leftSide />\r\n      <Wheel ref={wheel4} radius={radius} />\r\n    </group>\r\n  )\r\n}\r\n\r\nexport default Vehicle\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
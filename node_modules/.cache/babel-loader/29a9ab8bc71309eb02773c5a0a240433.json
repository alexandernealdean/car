{"ast":null,"code":"import _classCallCheck from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _construct from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/construct.js\";\nimport _objectWithoutProperties from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nimport _defineProperty from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _toArray from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/toArray.js\";\nimport _slicedToArray from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _toConsumableArray from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _objectSpread from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _createForOfIteratorHelper from \"C:/Users/Alex/Desktop/car/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nvar _excluded = [\"args\"],\n    _excluded2 = [\"args\"],\n    _excluded3 = [\"args\"],\n    _excluded4 = [\"params\"],\n    _excluded5 = [\"children\", \"fallback\", \"tabIndex\", \"resize\", \"id\", \"style\", \"className\", \"events\"],\n    _excluded6 = [\"gl\", \"size\", \"mode\", \"events\", \"onCreated\"];\nimport * as THREE from 'three';\nimport * as React from 'react';\nimport create from 'zustand';\nimport shallow from 'zustand/shallow';\nimport Reconciler from 'react-reconciler';\nimport { unstable_now, unstable_runWithPriority, unstable_IdlePriority } from 'scheduler';\nimport { useAsset } from 'use-asset';\nimport useMeasure from 'react-use-measure';\nvar threeTypes = /*#__PURE__*/Object.freeze({\n  __proto__: null\n});\nvar is = {\n  obj: function obj(a) {\n    return a === Object(a) && !is.arr(a) && typeof a !== 'function';\n  },\n  fun: function fun(a) {\n    return typeof a === 'function';\n  },\n  str: function str(a) {\n    return typeof a === 'string';\n  },\n  num: function num(a) {\n    return typeof a === 'number';\n  },\n  und: function und(a) {\n    return a === void 0;\n  },\n  arr: function arr(a) {\n    return Array.isArray(a);\n  },\n  equ: function equ(a, b) {\n    // Wrong type or one of the two undefined, doesn't match\n    if (typeof a !== typeof b || !!a !== !!b) return false; // Atomic, just compare a against b\n\n    if (is.str(a) || is.num(a) || is.obj(a)) return a === b; // Array, shallow compare first to see if it's a match\n\n    if (is.arr(a) && a == b) return true; // Last resort, go through keys\n\n    var i;\n\n    for (i in a) {\n      if (!(i in b)) return false;\n    }\n\n    for (i in b) {\n      if (a[i] !== b[i]) return false;\n    }\n\n    return is.und(i) ? a === b : true;\n  }\n};\n\nfunction makeId(event) {\n  return (event.eventObject || event.object).uuid + '/' + event.index;\n}\n\nfunction removeInteractivity(store, object) {\n  var _store$getState = store.getState(),\n      internal = _store$getState.internal; // Removes every trace of an object from the data store\n\n\n  internal.interaction = internal.interaction.filter(function (o) {\n    return o !== object;\n  });\n  internal.initialHits = internal.initialHits.filter(function (o) {\n    return o !== object;\n  });\n  internal.hovered.forEach(function (value, key) {\n    if (value.eventObject === object || value.object === object) {\n      internal.hovered.delete(key);\n    }\n  });\n}\n\nfunction createEvents(store) {\n  var temp = new THREE.Vector3();\n  /** Sets up defaultRaycaster */\n\n  function prepareRay(event) {\n    var _raycaster$computeOff;\n\n    var state = store.getState();\n    var raycaster = state.raycaster,\n        mouse = state.mouse,\n        camera = state.camera,\n        size = state.size; // https://github.com/pmndrs/react-three-fiber/pull/782\n    // Events trigger outside of canvas when moved\n\n    var _ref2 = (_raycaster$computeOff = raycaster.computeOffsets == null ? void 0 : raycaster.computeOffsets(event, state)) != null ? _raycaster$computeOff : event,\n        offsetX = _ref2.offsetX,\n        offsetY = _ref2.offsetY;\n\n    var width = size.width,\n        height = size.height;\n    mouse.set(offsetX / width * 2 - 1, -(offsetY / height) * 2 + 1);\n    raycaster.setFromCamera(mouse, camera);\n  }\n  /** Calculates delta */\n\n\n  function calculateDistance(event) {\n    var _store$getState2 = store.getState(),\n        internal = _store$getState2.internal;\n\n    var dx = event.offsetX - internal.initialClick[0];\n    var dy = event.offsetY - internal.initialClick[1];\n    return Math.round(Math.sqrt(dx * dx + dy * dy));\n  }\n  /** Returns true if an instance has a valid pointer-event registered, this excludes scroll, clicks etc */\n\n\n  function filterPointerEvents(objects) {\n    return objects.filter(function (obj) {\n      return ['Move', 'Over', 'Enter', 'Out', 'Leave'].some(function (name) {\n        var _r3f$handlers;\n\n        return (_r3f$handlers = obj.__r3f.handlers) == null ? void 0 : _r3f$handlers['onPointer' + name];\n      });\n    });\n  }\n\n  function intersect(filter) {\n    var state = store.getState();\n    var raycaster = state.raycaster,\n        internal = state.internal; // Skip event handling when noEvents is set\n\n    if (!raycaster.enabled) return [];\n    var seen = new Set();\n    var intersections = []; // Allow callers to eliminate event objects\n\n    var eventsObjects = filter ? filter(internal.interaction) : internal.interaction; // Intersect known handler objects and filter against duplicates\n\n    var intersects = raycaster.intersectObjects(eventsObjects, true).filter(function (item) {\n      var id = makeId(item);\n      if (seen.has(id)) return false;\n      seen.add(id);\n      return true;\n    }); // https://github.com/mrdoob/three.js/issues/16031\n    // Allow custom userland intersect sort order\n\n    if (raycaster.filter) intersects = raycaster.filter(intersects, state);\n\n    var _iterator = _createForOfIteratorHelper(intersects),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var _intersect = _step.value;\n        var eventObject = _intersect.object; // Bubble event up\n\n        while (eventObject) {\n          var _r3f;\n\n          var handlers = (_r3f = eventObject.__r3f) == null ? void 0 : _r3f.handlers;\n          if (handlers) intersections.push(_objectSpread(_objectSpread({}, _intersect), {}, {\n            eventObject: eventObject\n          }));\n          eventObject = eventObject.parent;\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    return intersections;\n  }\n  /**  Creates filtered intersects and returns an array of positive hits */\n\n\n  function patchIntersects(intersections, event) {\n    var _store$getState3 = store.getState(),\n        internal = _store$getState3.internal; // If the interaction is captured, make all capturing targets  part of the\n    // intersect.\n\n\n    if ('pointerId' in event && internal.capturedMap.has(event.pointerId)) {\n      intersections.push.apply(intersections, _toConsumableArray(internal.capturedMap.get(event.pointerId).values()));\n    }\n\n    return intersections;\n  }\n  /**  Handles intersections by forwarding them to handlers */\n\n\n  function handleIntersects(intersections, event, callback) {\n    var _store$getState4 = store.getState(),\n        raycaster = _store$getState4.raycaster,\n        mouse = _store$getState4.mouse,\n        camera = _store$getState4.camera,\n        internal = _store$getState4.internal; // If anything has been found, forward it to the event listeners\n\n\n    if (intersections.length) {\n      (function () {\n        var unprojectedPoint = temp.set(mouse.x, mouse.y, 0).unproject(camera);\n        var delta = event.type === 'click' ? calculateDistance(event) : 0;\n\n        var releasePointerCapture = function releasePointerCapture(id) {\n          return event.target.releasePointerCapture(id);\n        };\n\n        var localState = {\n          stopped: false\n        };\n\n        var _iterator2 = _createForOfIteratorHelper(intersections),\n            _step2;\n\n        try {\n          var _loop = function _loop() {\n            var hit = _step2.value;\n\n            var hasPointerCapture = function hasPointerCapture(id) {\n              var _internal$capturedMap, _internal$capturedMap2;\n\n              return (_internal$capturedMap = (_internal$capturedMap2 = internal.capturedMap.get(id)) == null ? void 0 : _internal$capturedMap2.has(hit.eventObject)) != null ? _internal$capturedMap : false;\n            };\n\n            var setPointerCapture = function setPointerCapture(id) {\n              if (internal.capturedMap.has(id)) {\n                // if the pointerId was previously captured, we add the hit to the\n                // event capturedMap.\n                internal.capturedMap.get(id).set(hit.eventObject, hit);\n              } else {\n                // if the pointerId was not previously captured, we create a map\n                // containing the hitObject, and the hit. hitObject is used for\n                // faster access.\n                internal.capturedMap.set(id, new Map([[hit.eventObject, hit]]));\n              } // Call the original event now\n\n\n              event.target.setPointerCapture(id);\n            }; // Add native event props\n\n\n            var extractEventProps = {};\n\n            for (var prop in Object.getPrototypeOf(event)) {\n              var property = event[prop]; // Only copy over atomics, leave functions alone as these should be\n              // called as event.nativeEvent.fn()\n\n              if (typeof property !== 'function') extractEventProps[prop] = property;\n            }\n\n            var raycastEvent = _objectSpread(_objectSpread(_objectSpread({}, hit), extractEventProps), {}, {\n              spaceX: mouse.x,\n              spaceY: mouse.y,\n              intersections: intersections,\n              stopped: localState.stopped,\n              delta: delta,\n              unprojectedPoint: unprojectedPoint,\n              ray: raycaster.ray,\n              camera: camera,\n              // Hijack stopPropagation, which just sets a flag\n              stopPropagation: function stopPropagation() {\n                // https://github.com/pmndrs/react-three-fiber/issues/596\n                // Events are not allowed to stop propagation if the pointer has been captured\n                var capturesForPointer = 'pointerId' in event && internal.capturedMap.get(event.pointerId); // We only authorize stopPropagation...\n\n                if ( // ...if this pointer hasn't been captured\n                !capturesForPointer || // ... or if the hit object is capturing the pointer\n                capturesForPointer.has(hit.eventObject)) {\n                  raycastEvent.stopped = localState.stopped = true; // Propagation is stopped, remove all other hover records\n                  // An event handler is only allowed to flush other handlers if it is hovered itself\n\n                  if (internal.hovered.size && Array.from(internal.hovered.values()).find(function (i) {\n                    return i.eventObject === hit.eventObject;\n                  })) {\n                    // Objects cannot flush out higher up objects that have already caught the event\n                    var higher = intersections.slice(0, intersections.indexOf(hit));\n                    cancelPointer([].concat(_toConsumableArray(higher), [hit]));\n                  }\n                }\n              },\n              // there should be a distinction between target and currentTarget\n              target: {\n                hasPointerCapture: hasPointerCapture,\n                setPointerCapture: setPointerCapture,\n                releasePointerCapture: releasePointerCapture\n              },\n              currentTarget: {\n                hasPointerCapture: hasPointerCapture,\n                setPointerCapture: setPointerCapture,\n                releasePointerCapture: releasePointerCapture\n              },\n              sourceEvent: event,\n              // deprecated\n              nativeEvent: event\n            }); // Call subscribers\n\n\n            callback(raycastEvent); // Event bubbling may be interrupted by stopPropagation\n\n            if (localState.stopped === true) return \"break\";\n          };\n\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var _ret = _loop();\n\n            if (_ret === \"break\") break;\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n      })();\n    }\n\n    return intersections;\n  }\n\n  function cancelPointer(hits) {\n    var _store$getState5 = store.getState(),\n        internal = _store$getState5.internal;\n\n    Array.from(internal.hovered.values()).forEach(function (hoveredObj) {\n      // When no objects were hit or the the hovered object wasn't found underneath the cursor\n      // we call onPointerOut and delete the object from the hovered-elements map\n      if (!hits.length || !hits.find(function (hit) {\n        return hit.object === hoveredObj.object && hit.index === hoveredObj.index;\n      })) {\n        var eventObject = hoveredObj.eventObject;\n        var handlers = eventObject.__r3f.handlers;\n        internal.hovered.delete(makeId(hoveredObj));\n\n        if (handlers) {\n          // Clear out intersects, they are outdated by now\n          var data = _objectSpread(_objectSpread({}, hoveredObj), {}, {\n            intersections: hits || []\n          });\n\n          handlers.onPointerOut == null ? void 0 : handlers.onPointerOut(data);\n          handlers.onPointerLeave == null ? void 0 : handlers.onPointerLeave(data);\n        }\n      }\n    });\n  }\n\n  var handlePointer = function handlePointer(name) {\n    // Deal with cancelation\n    switch (name) {\n      case 'onPointerLeave':\n      case 'onPointerCancel':\n        return function () {\n          return cancelPointer([]);\n        };\n\n      case 'onLostPointerCapture':\n        return function (event) {\n          if ('pointerId' in event) {\n            // this will be a problem if one target releases the pointerId\n            // and another one is still keeping it, as the line below\n            // indifferently deletes all capturing references.\n            store.getState().internal.capturedMap.delete(event.pointerId);\n          }\n\n          cancelPointer([]);\n        };\n    } // Any other pointer goes here ...\n\n\n    return function (event) {\n      var _store$getState6 = store.getState(),\n          onPointerMissed = _store$getState6.onPointerMissed,\n          internal = _store$getState6.internal;\n\n      prepareRay(event); // Get fresh intersects\n\n      var isPointerMove = name === 'onPointerMove';\n      var filter = isPointerMove ? filterPointerEvents : undefined;\n      var hits = patchIntersects(intersect(filter), event); // Take care of unhover\n\n      if (isPointerMove) cancelPointer(hits);\n      handleIntersects(hits, event, function (data) {\n        var eventObject = data.eventObject;\n        var handlers = eventObject.__r3f.handlers; // Check presence of handlers\n\n        if (!handlers) return;\n\n        if (isPointerMove) {\n          // Move event ...\n          if (handlers.onPointerOver || handlers.onPointerEnter || handlers.onPointerOut || handlers.onPointerLeave) {\n            // When enter or out is present take care of hover-state\n            var id = makeId(data);\n            var hoveredItem = internal.hovered.get(id);\n\n            if (!hoveredItem) {\n              // If the object wasn't previously hovered, book it and call its handler\n              internal.hovered.set(id, data);\n              handlers.onPointerOver == null ? void 0 : handlers.onPointerOver(data);\n              handlers.onPointerEnter == null ? void 0 : handlers.onPointerEnter(data);\n            } else if (hoveredItem.stopped) {\n              // If the object was previously hovered and stopped, we shouldn't allow other items to proceed\n              data.stopPropagation();\n            }\n          } // Call mouse move\n\n\n          handlers.onPointerMove == null ? void 0 : handlers.onPointerMove(data);\n        } else {\n          // All other events ...\n          var handler = handlers == null ? void 0 : handlers[name];\n\n          if (handler) {\n            // Forward all events back to their respective handlers with the exception of click events,\n            // which must use the initial target\n            if (name !== 'onClick' && name !== 'onContextMenu' && name !== 'onDoubleClick' || internal.initialHits.includes(eventObject)) {\n              handler(data);\n              pointerMissed(event, internal.interaction.filter(function (object) {\n                return object !== eventObject;\n              }));\n            }\n          }\n        }\n      }); // Save initial coordinates on pointer-down\n\n      if (name === 'onPointerDown') {\n        internal.initialClick = [event.offsetX, event.offsetY];\n        internal.initialHits = hits.map(function (hit) {\n          return hit.eventObject;\n        });\n      } // If a click yields no results, pass it back to the user as a miss\n\n\n      if ((name === 'onClick' || name === 'onContextMenu' || name === 'onDoubleClick') && !hits.length) {\n        if (calculateDistance(event) <= 2) {\n          pointerMissed(event, internal.interaction);\n          if (onPointerMissed) onPointerMissed(event);\n        }\n      }\n    };\n  };\n\n  function pointerMissed(event, objects) {\n    objects.forEach(function (object) {\n      var _r3f$handlers2;\n\n      return (_r3f$handlers2 = object.__r3f.handlers) == null ? void 0 : _r3f$handlers2.onPointerMissed == null ? void 0 : _r3f$handlers2.onPointerMissed(event);\n    });\n  }\n\n  return {\n    handlePointer: handlePointer\n  };\n} // Type guard to tell a store from a portal\n\n\nvar isStore = function isStore(def) {\n  return def && !!def.getState;\n};\n\nvar getContainer = function getContainer(container, child) {\n  var _container$__r3f$root, _container$__r3f;\n\n  return {\n    // If the container is not a root-store then it must be a THREE.Object3D into which part of the\n    // scene is portalled into. Now there can be two variants of this, either that object is part of\n    // the regular jsx tree, in which case it already has __r3f with a valid root attached, or it lies\n    // outside react, in which case we must take the root of the child that is about to be attached to it.\n    root: isStore(container) ? container : (_container$__r3f$root = (_container$__r3f = container.__r3f) == null ? void 0 : _container$__r3f.root) != null ? _container$__r3f$root : child.__r3f.root,\n    // The container is the eventual target into which objects are mounted, it has to be a THREE.Object3D\n    container: isStore(container) ? container.getState().scene : container\n  };\n};\n\nvar DEFAULT = '__default';\nvar EMPTY = {};\nvar FILTER = ['children', 'key', 'ref'];\nvar catalogue = {};\n\nvar extend = function extend(objects) {\n  return void (catalogue = _objectSpread(_objectSpread({}, catalogue), objects));\n}; // Each object in the scene carries a small LocalState descriptor\n\n\nfunction prepare(object, state) {\n  var instance = object;\n\n  if (state != null && state.instance || !instance.__r3f) {\n    instance.__r3f = _objectSpread({\n      root: null,\n      memoizedProps: {},\n      objects: []\n    }, state);\n  }\n\n  return object;\n}\n\nfunction createRenderer(roots) {\n  function applyProps(instance, newProps) {\n    var oldProps = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var accumulative = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n    var _instance$__r3f, _root$getState, _instance$__r3f2; // Filter equals, events and reserved props\n\n\n    var localState = (_instance$__r3f = instance == null ? void 0 : instance.__r3f) != null ? _instance$__r3f : {};\n    var root = localState.root;\n    var rootState = (_root$getState = root == null ? void 0 : root.getState == null ? void 0 : root.getState()) != null ? _root$getState : {};\n    var sameProps = [];\n    var handlers = [];\n    var newMemoizedProps = {};\n    var i = 0;\n    Object.entries(newProps).forEach(function (_ref3) {\n      var _ref4 = _slicedToArray(_ref3, 2),\n          key = _ref4[0],\n          entry = _ref4[1];\n\n      // we don't want children, ref or key in the memoized props\n      if (FILTER.indexOf(key) === -1) {\n        newMemoizedProps[key] = entry;\n      }\n    });\n\n    if (localState.memoizedProps && localState.memoizedProps.args) {\n      newMemoizedProps.args = localState.memoizedProps.args;\n    }\n\n    if (localState.memoizedProps && localState.memoizedProps.attach) {\n      newMemoizedProps.attach = localState.memoizedProps.attach;\n    }\n\n    if (instance.__r3f) {\n      instance.__r3f.memoizedProps = newMemoizedProps;\n    }\n\n    var objectKeys = Object.keys(newProps);\n\n    for (i = 0; i < objectKeys.length; i++) {\n      if (is.equ(newProps[objectKeys[i]], oldProps[objectKeys[i]])) {\n        sameProps.push(objectKeys[i]);\n      } // Event-handlers ...\n      //   are functions, that\n      //   start with \"on\", and\n      //   contain the name \"Pointer\", \"Click\", \"DoubleClick\", \"ContextMenu\", or \"Wheel\"\n\n\n      if (is.fun(newProps[objectKeys[i]]) && /^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(objectKeys[i])) {\n        handlers.push(objectKeys[i]);\n      }\n    } // Catch props that existed, but now exist no more ...\n\n\n    var leftOvers = [];\n\n    if (accumulative) {\n      objectKeys = Object.keys(oldProps);\n\n      for (i = 0; i < objectKeys.length; i++) {\n        if (!newProps.hasOwnProperty(objectKeys[i])) {\n          leftOvers.push(objectKeys[i]);\n        }\n      }\n    }\n\n    var toFilter = [].concat(sameProps, FILTER); // Instances use \"object\" as a reserved identifier\n\n    if ((_instance$__r3f2 = instance.__r3f) != null && _instance$__r3f2.instance) toFilter.push('object');\n\n    var filteredProps = _objectSpread({}, newProps); // Removes sameProps and reserved props from newProps\n\n\n    objectKeys = Object.keys(filteredProps);\n\n    for (i = 0; i < objectKeys.length; i++) {\n      if (toFilter.indexOf(objectKeys[i]) > -1) {\n        delete filteredProps[objectKeys[i]];\n      }\n    } // Collect all new props\n\n\n    var filteredPropsEntries = Object.entries(filteredProps); // Prepend left-overs so they can be reset or removed\n    // Left-overs must come first!\n\n    for (i = 0; i < leftOvers.length; i++) {\n      if (leftOvers[i] !== 'children') {\n        filteredPropsEntries.unshift([leftOvers[i], DEFAULT + 'remove']);\n      }\n    }\n\n    if (filteredPropsEntries.length > 0) {\n      filteredPropsEntries.forEach(function (_ref5) {\n        var _ref6 = _slicedToArray(_ref5, 2),\n            key = _ref6[0],\n            value = _ref6[1];\n\n        if (!handlers.includes(key)) {\n          var currentInstance = instance;\n          var targetProp = currentInstance[key];\n\n          if (key.includes('-')) {\n            var entries = key.split('-');\n            targetProp = entries.reduce(function (acc, key) {\n              return acc[key];\n            }, instance); // If the target is atomic, it forces us to switch the root\n\n            if (!(targetProp && targetProp.set)) {\n              var _entries$reverse = entries.reverse(),\n                  _entries$reverse2 = _toArray(_entries$reverse),\n                  name = _entries$reverse2[0],\n                  reverseEntries = _entries$reverse2.slice(1);\n\n              currentInstance = reverseEntries.reverse().reduce(function (acc, key) {\n                return acc[key];\n              }, instance);\n              key = name;\n            }\n          } // https://github.com/mrdoob/three.js/issues/21209\n          // HMR/fast-refresh relies on the ability to cancel out props, but threejs\n          // has no means to do this. Hence we curate a small collection of value-classes\n          // with their respective constructor/set arguments\n          // For removed props, try to set default values, if possible\n\n\n          if (value === DEFAULT + 'remove') {\n            if (targetProp && targetProp.constructor) {\n              // use the prop constructor to find the default it should be\n              value = new targetProp.constructor(newMemoizedProps.args);\n            } else if (currentInstance.constructor) {\n              // create a blank slate of the instance and copy the particular parameter.\n              // @ts-ignore\n              var defaultClassCall = new currentInstance.constructor(currentInstance.__r3f.memoizedProps.args);\n              value = defaultClassCall[targetProp]; // destory the instance\n\n              if (defaultClassCall.dispose) {\n                defaultClassCall.dispose();\n              }\n            } else {\n              // instance does not have constructor, just set it to 0\n              value = 0;\n            }\n          } // Special treatment for objects with support for set/copy, and layers\n\n\n          if (targetProp && targetProp.set && (targetProp.copy || targetProp instanceof THREE.Layers)) {\n            // If value is an array\n            if (Array.isArray(value)) {\n              if (targetProp.fromArray) {\n                targetProp.fromArray(value);\n              } else {\n                var _targetProp;\n\n                (_targetProp = targetProp).set.apply(_targetProp, _toConsumableArray(value));\n              }\n            } // Test again target.copy(class) next ...\n            else if (targetProp.copy && value && value.constructor && targetProp.constructor.name === value.constructor.name) {\n              targetProp.copy(value);\n            } // If nothing else fits, just set the single value, ignore undefined\n            // https://github.com/react-spring/react-three-fiber/issues/274\n            else if (value !== undefined) {\n              var isColor = targetProp instanceof THREE.Color; // Allow setting array scalars\n\n              if (!isColor && targetProp.setScalar) targetProp.setScalar(value); // Layers have no copy function, we must therefore copy the mask property\n              else if (targetProp instanceof THREE.Layers && value instanceof THREE.Layers) targetProp.mask = value.mask; // Otherwise just set ...\n              else targetProp.set(value); // Auto-convert sRGB colors, for now ...\n              // https://github.com/react-spring/react-three-fiber/issues/344\n\n              if (!rootState.linear && isColor) targetProp.convertSRGBToLinear();\n            } // Else, just overwrite the value\n\n          } else {\n            currentInstance[key] = value; // Auto-convert sRGB textures, for now ...\n            // https://github.com/react-spring/react-three-fiber/issues/344\n\n            if (!rootState.linear && currentInstance[key] instanceof THREE.Texture) currentInstance[key].encoding = THREE.sRGBEncoding;\n          }\n\n          invalidateInstance(instance);\n        }\n      }); // Preemptively delete the instance from the containers interaction\n\n      if (accumulative && root && instance.raycast && localState.handlers) {\n        localState.handlers = undefined;\n        var index = rootState.internal.interaction.indexOf(instance);\n        if (index > -1) rootState.internal.interaction.splice(index, 1);\n      } // Prep interaction handlers\n\n\n      if (handlers.length) {\n        if (accumulative && root && instance.raycast) {\n          rootState.internal.interaction.push(instance);\n        } // Add handlers to the instances handler-map\n\n\n        localState.handlers = handlers.reduce(function (acc, key) {\n          return _objectSpread(_objectSpread({}, acc), {}, _defineProperty({}, key, newProps[key]));\n        }, {});\n      } // Call the update lifecycle when it is being updated, but only when it is part of the scene\n\n\n      if (instance.parent) updateInstance(instance);\n    }\n  }\n\n  function invalidateInstance(instance) {\n    var _instance$__r3f3, _instance$__r3f3$root;\n\n    var state = (_instance$__r3f3 = instance.__r3f) == null ? void 0 : (_instance$__r3f3$root = _instance$__r3f3.root) == null ? void 0 : _instance$__r3f3$root.getState == null ? void 0 : _instance$__r3f3$root.getState();\n    if (state && state.internal.frames === 0) state.invalidate();\n  }\n\n  function updateInstance(instance) {\n    instance.onUpdate == null ? void 0 : instance.onUpdate(instance);\n  }\n\n  function createInstance(type, _ref7, root, hostContext, internalInstanceHandle) {\n    var _ref7$args = _ref7.args,\n        args = _ref7$args === void 0 ? [] : _ref7$args,\n        props = _objectWithoutProperties(_ref7, _excluded);\n\n    var name = \"\".concat(type[0].toUpperCase()).concat(type.slice(1));\n    var instance; // https://github.com/facebook/react/issues/17147\n    // Portals do not give us a root, they are themselves treated as a root by the reconciler\n    // In order to figure out the actual root we have to climb through fiber internals :(\n\n    if (!isStore(root) && internalInstanceHandle) {\n      var fn = function fn(node) {\n        if (!node.return) return node.stateNode && node.stateNode.containerInfo;else return fn(node.return);\n      };\n\n      root = fn(internalInstanceHandle);\n    } // Assert that by now we have a valid root\n\n\n    if (!root || !isStore(root)) throw \"No valid root for \".concat(name, \"!\");\n\n    if (type === 'primitive') {\n      if (props.object === undefined) throw \"Primitives without 'object' are invalid!\";\n      var object = props.object;\n      instance = prepare(object, {\n        root: root,\n        instance: true\n      });\n    } else {\n      var target = catalogue[name] || THREE[name];\n      if (!target) throw \"\".concat(name, \" is not part of the THREE namespace! Did you forget to extend? See: https://github.com/pmndrs/react-three-fiber/blob/master/markdown/api.md#using-3rd-party-objects-declaratively\");\n      var isArgsArr = is.arr(args); // Instanciate new object, link it to the root\n\n      instance = prepare(isArgsArr ? _construct(target, _toConsumableArray(args)) : new target(args), {\n        root: root,\n        // append memoized props with args so it's not forgotten\n        memoizedProps: {\n          args: isArgsArr && args.length === 0 ? null : args\n        }\n      });\n    } // Auto-attach geometries and materials\n\n\n    if (name.endsWith('Geometry')) {\n      props = _objectSpread({\n        attach: 'geometry'\n      }, props);\n    } else if (name.endsWith('Material')) {\n      props = _objectSpread({\n        attach: 'material'\n      }, props);\n    } // It should NOT call onUpdate on object instanciation, because it hasn't been added to the\n    // view yet. If the callback relies on references for instance, they won't be ready yet, this is\n    // why it passes \"true\" here\n\n\n    applyProps(instance, props, {});\n    return instance;\n  }\n\n  function appendChild(parentInstance, child) {\n    var addedAsChild = false;\n\n    if (child) {\n      // The attach attribute implies that the object attaches itself on the parent\n      if (child.attachArray) {\n        if (!is.arr(parentInstance[child.attachArray])) parentInstance[child.attachArray] = [];\n        parentInstance[child.attachArray].push(child);\n      } else if (child.attachObject) {\n        if (!is.obj(parentInstance[child.attachObject[0]])) parentInstance[child.attachObject[0]] = {};\n        parentInstance[child.attachObject[0]][child.attachObject[1]] = child;\n      } else if (child.attach && !is.fun(child.attach)) {\n        parentInstance[child.attach] = child;\n      } else if (child.isObject3D) {\n        // add in the usual parent-child way\n        parentInstance.add(child);\n        addedAsChild = true;\n      }\n\n      if (!addedAsChild) {\n        // This is for anything that used attach, and for non-Object3Ds that don't get attached to props;\n        // that is, anything that's a child in React but not a child in the scenegraph.\n        parentInstance.__r3f.objects.push(child);\n\n        child.parent = parentInstance;\n      }\n\n      updateInstance(child);\n      invalidateInstance(child);\n    }\n  }\n\n  function insertBefore(parentInstance, child, beforeChild) {\n    var added = false;\n\n    if (child) {\n      if (child.attachArray) {\n        var array = parentInstance[child.attachArray];\n        if (!is.arr(array)) parentInstance[child.attachArray] = [];\n        array.splice(array.indexOf(beforeChild), 0, child);\n      } else if (child.attachObject || child.attach && !is.fun(child.attach)) {\n        // attach and attachObject don't have an order anyway, so just append\n        added = true;\n        return appendChild(parentInstance, child);\n      } else if (child.isObject3D) {\n        child.parent = parentInstance;\n        child.dispatchEvent({\n          type: 'added'\n        });\n        var restSiblings = parentInstance.children.filter(function (sibling) {\n          return sibling !== child;\n        });\n        var index = restSiblings.indexOf(beforeChild);\n        parentInstance.children = [].concat(_toConsumableArray(restSiblings.slice(0, index)), [child], _toConsumableArray(restSiblings.slice(index)));\n        added = true;\n      }\n\n      if (!added) {\n        parentInstance.__r3f.objects.push(child);\n\n        child.parent = parentInstance;\n      }\n\n      updateInstance(child);\n      invalidateInstance(child);\n    }\n  }\n\n  function removeRecursive(array, parent) {\n    var dispose = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (array) _toConsumableArray(array).forEach(function (child) {\n      return removeChild(parent, child, dispose);\n    });\n  }\n\n  function removeChild(parentInstance, child, dispose) {\n    if (child) {\n      var _child$__r3f2;\n\n      if (parentInstance.__r3f.objects) {\n        var oldLength = parentInstance.__r3f.objects.length;\n        parentInstance.__r3f.objects = parentInstance.__r3f.objects.filter(function (x) {\n          return x !== child;\n        });\n        var newLength = parentInstance.__r3f.objects.length; // was it in the list?\n\n        if (newLength < oldLength) {\n          // we had also set this, so we must clear it now\n          child.parent = null;\n        }\n      } // Remove attachment\n\n\n      if (child.attachArray) {\n        parentInstance[child.attachArray] = parentInstance[child.attachArray].filter(function (x) {\n          return x !== child;\n        });\n      } else if (child.attachObject) {\n        delete parentInstance[child.attachObject[0]][child.attachObject[1]];\n      } else if (child.attach && !is.fun(child.attach)) {\n        parentInstance[child.attach] = null;\n      } else if (child.isObject3D) {\n        var _child$__r3f;\n\n        parentInstance.remove(child); // Remove interactivity\n\n        if ((_child$__r3f = child.__r3f) != null && _child$__r3f.root) {\n          removeInteractivity(child.__r3f.root, child);\n        }\n      } // Allow objects to bail out of recursive dispose alltogether by passing dispose={null}\n      // Never dispose of primitives because their state may be kept outside of React!\n      // In order for an object to be able to dispose it has to have\n      //   - a dispose method,\n      //   - it cannot be an <instance object={...} />\n      //   - it cannot be a THREE.Scene, because three has broken it's own api\n      //\n      // Since disposal is recursive, we can check the optional dispose arg, which will be undefined\n      // when the reconciler calls it, but then carry our own check recursively\n\n\n      var isInstance = (_child$__r3f2 = child.__r3f) == null ? void 0 : _child$__r3f2.instance;\n      var shouldDispose = dispose === undefined ? child.dispose !== null && !isInstance : dispose; // Remove nested child objects. Primitives should not have objects and children that are\n      // attached to them declaratively ...\n\n      if (!isInstance) {\n        var _child$__r3f3;\n\n        removeRecursive((_child$__r3f3 = child.__r3f) == null ? void 0 : _child$__r3f3.objects, child, shouldDispose);\n        removeRecursive(child.children, child, shouldDispose);\n      } // Remove references\n\n\n      if (child.__r3f) {\n        delete child.__r3f.root;\n        delete child.__r3f.objects;\n        delete child.__r3f.handlers;\n        delete child.__r3f.memoizedProps;\n        if (!isInstance) delete child.__r3f;\n      } // Dispose item whenever the reconciler feels like it\n\n\n      if (shouldDispose && child.dispose && child.type !== 'Scene') {\n        unstable_runWithPriority(unstable_IdlePriority, function () {\n          return child.dispose();\n        });\n      }\n\n      invalidateInstance(parentInstance);\n    }\n  }\n\n  function switchInstance(instance, type, newProps, fiber) {\n    var parent = instance.parent;\n    if (!parent) return;\n    var newInstance = createInstance(type, newProps, instance.__r3f.root); // https://github.com/pmndrs/react-three-fiber/issues/1348\n    // When args change the instance has to be re-constructed, which then\n    // forces r3f to re-parent the children and non-scene objects\n\n    if (instance.children) {\n      instance.children.forEach(function (child) {\n        return appendChild(newInstance, child);\n      });\n      instance.children = [];\n    }\n\n    instance.__r3f.objects.forEach(function (child) {\n      return appendChild(newInstance, child);\n    });\n\n    instance.__r3f.objects = [];\n    removeChild(parent, instance);\n    appendChild(parent, newInstance) // This evil hack switches the react-internal fiber node\n    // https://github.com/facebook/react/issues/14983\n    // https://github.com/facebook/react/pull/15021\n    ;\n    [fiber, fiber.alternate].forEach(function (fiber) {\n      if (fiber !== null) {\n        fiber.stateNode = newInstance;\n\n        if (fiber.ref) {\n          if (typeof fiber.ref === 'function') fiber.ref(newInstance);else fiber.ref.current = newInstance;\n        }\n      }\n    });\n  }\n\n  var reconciler = Reconciler({\n    now: unstable_now,\n    createInstance: createInstance,\n    removeChild: removeChild,\n    appendChild: appendChild,\n    appendInitialChild: appendChild,\n    insertBefore: insertBefore,\n    warnsIfNotActing: true,\n    supportsMutation: true,\n    isPrimaryRenderer: false,\n    // @ts-ignore\n    scheduleTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n    // @ts-ignore\n    cancelTimeout: is.fun(clearTimeout) ? clearTimeout : undefined,\n    // @ts-ignore\n    setTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n    // @ts-ignore\n    clearTimeout: is.fun(clearTimeout) ? clearTimeout : undefined,\n    noTimeout: -1,\n    appendChildToContainer: function appendChildToContainer(parentInstance, child) {\n      var _getContainer = getContainer(parentInstance, child),\n          container = _getContainer.container,\n          root = _getContainer.root; // Link current root to the default scene\n\n\n      container.__r3f.root = root;\n      appendChild(container, child);\n    },\n    removeChildFromContainer: function removeChildFromContainer(parentInstance, child) {\n      var _getContainer2 = getContainer(parentInstance, child),\n          container = _getContainer2.container;\n\n      removeChild(container, child);\n    },\n    insertInContainerBefore: function insertInContainerBefore(parentInstance, child, beforeChild) {\n      var _getContainer3 = getContainer(parentInstance, child),\n          container = _getContainer3.container;\n\n      insertBefore(container, child, beforeChild);\n    },\n    commitUpdate: function commitUpdate(instance, updatePayload, type, oldProps, newProps, fiber) {\n      if (instance.__r3f.instance && newProps.object && newProps.object !== instance) {\n        // <instance object={...} /> where the object reference has changed\n        switchInstance(instance, type, newProps, fiber);\n      } else {\n        // This is a data object, let's extract critical information about it\n        var _newProps$args = newProps.args,\n            argsNew = _newProps$args === void 0 ? [] : _newProps$args,\n            restNew = _objectWithoutProperties(newProps, _excluded2);\n\n        var _oldProps$args = oldProps.args,\n            argsOld = _oldProps$args === void 0 ? [] : _oldProps$args,\n            restOld = _objectWithoutProperties(oldProps, _excluded3); // If it has new props or arguments, then it needs to be re-instanciated\n\n\n        var hasNewArgs = argsNew.some(function (value, index) {\n          return is.obj(value) ? Object.entries(value).some(function (_ref8) {\n            var _ref9 = _slicedToArray(_ref8, 2),\n                key = _ref9[0],\n                val = _ref9[1];\n\n            return val !== argsOld[index][key];\n          }) : value !== argsOld[index];\n        });\n\n        if (hasNewArgs) {\n          // Next we create a new instance and append it again\n          switchInstance(instance, type, newProps, fiber);\n        } else {\n          // Otherwise just overwrite props\n          applyProps(instance, restNew, restOld, true);\n        }\n      }\n    },\n    hideInstance: function hideInstance(instance) {\n      if (instance.isObject3D) {\n        instance.visible = false;\n        invalidateInstance(instance);\n      }\n    },\n    unhideInstance: function unhideInstance(instance, props) {\n      if (instance.isObject3D && props.visible == null || props.visible) {\n        instance.visible = true;\n        invalidateInstance(instance);\n      }\n    },\n    hideTextInstance: function hideTextInstance() {\n      throw new Error('Text is not allowed in the R3F tree.');\n    },\n    getPublicInstance: function getPublicInstance(instance) {\n      // TODO: might fix switchInstance (?)\n      return instance;\n    },\n    getRootHostContext: function getRootHostContext(rootContainer) {\n      return EMPTY;\n    },\n    getChildHostContext: function getChildHostContext(parentHostContext) {\n      return EMPTY;\n    },\n    createTextInstance: function createTextInstance() {},\n    finalizeInitialChildren: function finalizeInitialChildren(instance) {\n      // https://github.com/facebook/react/issues/20271\n      // Returning true will trigger commitMount\n      return !!instance.__r3f.handlers;\n    },\n    commitMount: function commitMount(instance)\n    /*, type, props*/\n    {\n      // https://github.com/facebook/react/issues/20271\n      // This will make sure events are only added once to the central container\n      if (instance.raycast && instance.__r3f.handlers) instance.__r3f.root.getState().internal.interaction.push(instance);\n    },\n    prepareUpdate: function prepareUpdate() {\n      return EMPTY;\n    },\n    shouldDeprioritizeSubtree: function shouldDeprioritizeSubtree() {\n      return false;\n    },\n    prepareForCommit: function prepareForCommit() {\n      return null;\n    },\n    preparePortalMount: function preparePortalMount() {// noop\n    },\n    resetAfterCommit: function resetAfterCommit() {// noop\n    },\n    shouldSetTextContent: function shouldSetTextContent() {\n      return false;\n    },\n    clearContainer: function clearContainer() {\n      return false;\n    }\n  });\n  return {\n    reconciler: reconciler,\n    applyProps: applyProps\n  };\n}\n\nvar isRenderer = function isRenderer(def) {\n  return def && !!def.render;\n};\n\nvar isOrthographicCamera = function isOrthographicCamera(def) {\n  return def && def.isOrthographicCamera;\n};\n\nvar context = /*#__PURE__*/React.createContext(null);\n\nvar createStore = function createStore(applyProps, _invalidate, _advance, props) {\n  var gl = props.gl,\n      size = props.size,\n      _props$shadows = props.shadows,\n      shadows = _props$shadows === void 0 ? false : _props$shadows,\n      _props$linear = props.linear,\n      linear = _props$linear === void 0 ? false : _props$linear,\n      _props$flat = props.flat,\n      flat = _props$flat === void 0 ? false : _props$flat,\n      _props$vr = props.vr,\n      vr = _props$vr === void 0 ? false : _props$vr,\n      _props$orthographic = props.orthographic,\n      orthographic = _props$orthographic === void 0 ? false : _props$orthographic,\n      _props$frameloop = props.frameloop,\n      frameloop = _props$frameloop === void 0 ? 'always' : _props$frameloop,\n      _props$dpr = props.dpr,\n      dpr = _props$dpr === void 0 ? 1 : _props$dpr,\n      performance = props.performance,\n      _props$clock = props.clock,\n      clock = _props$clock === void 0 ? new THREE.Clock() : _props$clock,\n      raycastOptions = props.raycaster,\n      cameraOptions = props.camera,\n      onPointerMissed = props.onPointerMissed; // Set shadowmap\n\n  if (shadows) {\n    gl.shadowMap.enabled = true;\n    if (typeof shadows === 'object') Object.assign(gl.shadowMap, shadows);else gl.shadowMap.type = THREE.PCFSoftShadowMap;\n  } // Set color management\n\n\n  if (!linear) {\n    if (!flat) gl.toneMapping = THREE.ACESFilmicToneMapping;\n    gl.outputEncoding = THREE.sRGBEncoding;\n  } // clock.elapsedTime is updated using advance(timestamp)\n\n\n  if (frameloop === 'never') {\n    clock.stop();\n    clock.elapsedTime = 0;\n  }\n\n  var rootState = create(function (set, get) {\n    // Create custom raycaster\n    var raycaster = new THREE.Raycaster();\n\n    var _ref10 = raycastOptions || {},\n        params = _ref10.params,\n        options = _objectWithoutProperties(_ref10, _excluded4);\n\n    applyProps(raycaster, _objectSpread(_objectSpread({\n      enabled: true\n    }, options), {}, {\n      params: _objectSpread(_objectSpread({}, raycaster.params), params)\n    }), {}); // Create default camera\n\n    var isCamera = cameraOptions instanceof THREE.Camera;\n    var camera = isCamera ? cameraOptions : orthographic ? new THREE.OrthographicCamera(0, 0, 0, 0, 0.1, 1000) : new THREE.PerspectiveCamera(75, 0, 0.1, 1000);\n\n    if (!isCamera) {\n      camera.position.z = 5;\n      if (cameraOptions) applyProps(camera, cameraOptions, {}); // Always look at center by default\n\n      camera.lookAt(0, 0, 0);\n    }\n\n    function _setDpr(dpr) {\n      return Array.isArray(dpr) ? Math.min(Math.max(dpr[0], window.devicePixelRatio), dpr[1]) : dpr;\n    }\n\n    var initialDpr = _setDpr(dpr);\n\n    var position = new THREE.Vector3();\n    var defaultTarget = new THREE.Vector3();\n\n    function getCurrentViewport() {\n      var camera = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : get().camera;\n      var target = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultTarget;\n      var size = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : get().size;\n      var width = size.width,\n          height = size.height;\n      var aspect = width / height;\n      var distance = camera.getWorldPosition(position).distanceTo(target);\n\n      if (isOrthographicCamera(camera)) {\n        return {\n          width: width / camera.zoom,\n          height: height / camera.zoom,\n          factor: 1,\n          distance: distance,\n          aspect: aspect\n        };\n      } else {\n        var fov = camera.fov * Math.PI / 180; // convert vertical fov to radians\n\n        var h = 2 * Math.tan(fov / 2) * distance; // visible height\n\n        var w = h * (width / height);\n        return {\n          width: w,\n          height: h,\n          factor: width / w,\n          distance: distance,\n          aspect: aspect\n        };\n      }\n    }\n\n    var performanceTimeout = undefined;\n\n    var setPerformanceCurrent = function setPerformanceCurrent(current) {\n      return set(function (state) {\n        return {\n          performance: _objectSpread(_objectSpread({}, state.performance), {}, {\n            current: current\n          })\n        };\n      });\n    };\n\n    return {\n      gl: gl,\n      set: set,\n      get: get,\n      invalidate: function invalidate() {\n        return _invalidate(get());\n      },\n      advance: function advance(timestamp, runGlobalEffects) {\n        return _advance(timestamp, runGlobalEffects, get());\n      },\n      linear: linear,\n      flat: flat,\n      scene: prepare(new THREE.Scene()),\n      camera: camera,\n      raycaster: raycaster,\n      clock: clock,\n      mouse: new THREE.Vector2(),\n      vr: vr,\n      frameloop: frameloop,\n      onPointerMissed: onPointerMissed,\n      performance: _objectSpread(_objectSpread({\n        current: 1,\n        min: 0.5,\n        max: 1,\n        debounce: 200\n      }, performance), {}, {\n        regress: function regress() {\n          var state = get(); // Clear timeout\n\n          if (performanceTimeout) clearTimeout(performanceTimeout); // Set lower bound performance\n\n          if (state.performance.current !== state.performance.min) setPerformanceCurrent(state.performance.min); // Go back to upper bound performance after a while unless something regresses meanwhile\n\n          performanceTimeout = setTimeout(function () {\n            return setPerformanceCurrent(get().performance.max);\n          }, state.performance.debounce);\n        }\n      }),\n      size: {\n        width: 0,\n        height: 0\n      },\n      viewport: {\n        initialDpr: initialDpr,\n        dpr: initialDpr,\n        width: 0,\n        height: 0,\n        aspect: 0,\n        distance: 0,\n        factor: 0,\n        getCurrentViewport: getCurrentViewport\n      },\n      setSize: function setSize(width, height) {\n        var size = {\n          width: width,\n          height: height\n        };\n        set(function (state) {\n          return {\n            size: size,\n            viewport: _objectSpread(_objectSpread({}, state.viewport), getCurrentViewport(camera, defaultTarget, size))\n          };\n        });\n      },\n      setDpr: function setDpr(dpr) {\n        return set(function (state) {\n          return {\n            viewport: _objectSpread(_objectSpread({}, state.viewport), {}, {\n              dpr: _setDpr(dpr)\n            })\n          };\n        });\n      },\n      events: {\n        connected: false\n      },\n      internal: {\n        active: false,\n        priority: 0,\n        frames: 0,\n        lastProps: props,\n        interaction: [],\n        hovered: new Map(),\n        subscribers: [],\n        initialClick: [0, 0],\n        initialHits: [],\n        capturedMap: new Map(),\n        subscribe: function subscribe(ref) {\n          var priority = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n          set(function (_ref11) {\n            var internal = _ref11.internal;\n            return {\n              internal: _objectSpread(_objectSpread({}, internal), {}, {\n                // If this subscription was given a priority, it takes rendering into its own hands\n                // For that reason we switch off automatic rendering and increase the manual flag\n                // As long as this flag is positive (there could be multiple render subscription)\n                // ..there can be no internal rendering at all\n                priority: internal.priority + (priority ? 1 : 0),\n                // Register subscriber and sort layers from lowest to highest, meaning,\n                // highest priority renders last (on top of the other frames)\n                subscribers: [].concat(_toConsumableArray(internal.subscribers), [{\n                  ref: ref,\n                  priority: priority\n                }]).sort(function (a, b) {\n                  return a.priority - b.priority;\n                })\n              })\n            };\n          });\n          return function () {\n            set(function (_ref12) {\n              var internal = _ref12.internal;\n              return {\n                internal: _objectSpread(_objectSpread({}, internal), {}, {\n                  // Decrease manual flag if this subscription had a priority\n                  priority: internal.priority - (priority ? 1 : 0),\n                  // Remove subscriber from list\n                  subscribers: internal.subscribers.filter(function (s) {\n                    return s.ref !== ref;\n                  })\n                })\n              };\n            });\n          };\n        }\n      }\n    };\n  }); // Resize camera and renderer on changes to size and pixelratio\n\n  rootState.subscribe(function () {\n    var _rootState$getState = rootState.getState(),\n        camera = _rootState$getState.camera,\n        size = _rootState$getState.size,\n        viewport = _rootState$getState.viewport,\n        internal = _rootState$getState.internal; // https://github.com/pmndrs/react-three-fiber/issues/92\n    // Do not mess with the camera if it belongs to the user\n\n\n    if (!(internal.lastProps.camera instanceof THREE.Camera)) {\n      if (isOrthographicCamera(camera)) {\n        camera.left = size.width / -2;\n        camera.right = size.width / 2;\n        camera.top = size.height / 2;\n        camera.bottom = size.height / -2;\n      } else {\n        camera.aspect = size.width / size.height;\n      }\n\n      camera.updateProjectionMatrix(); // https://github.com/pmndrs/react-three-fiber/issues/178\n      // Update matrix world since the renderer is a frame late\n\n      camera.updateMatrixWorld();\n    } // Update renderer\n\n\n    gl.setPixelRatio(viewport.dpr);\n    gl.setSize(size.width, size.height);\n  }, function (state) {\n    return [state.viewport.dpr, state.size];\n  }, shallow);\n  var state = rootState.getState(); // Update size\n\n  if (size) state.setSize(size.width, size.height); // Invalidate on any change\n\n  rootState.subscribe(function (state) {\n    return _invalidate(state);\n  }); // Return root state\n\n  return rootState;\n};\n\nfunction createSubs(callback, subs) {\n  var index = subs.length;\n  subs.push(callback);\n  return function () {\n    return void subs.splice(index, 1);\n  };\n}\n\nvar i;\nvar globalEffects = [];\nvar globalAfterEffects = [];\nvar globalTailEffects = [];\n\nvar addEffect = function addEffect(callback) {\n  return createSubs(callback, globalEffects);\n};\n\nvar addAfterEffect = function addAfterEffect(callback) {\n  return createSubs(callback, globalAfterEffects);\n};\n\nvar addTail = function addTail(callback) {\n  return createSubs(callback, globalTailEffects);\n};\n\nfunction run(effects, timestamp) {\n  for (i = 0; i < effects.length; i++) {\n    effects[i](timestamp);\n  }\n}\n\nfunction render$1(timestamp, state) {\n  // Run local effects\n  var delta = state.clock.getDelta(); // In frameloop='never' mode, clock times are updated using the provided timestamp\n\n  if (state.frameloop === 'never' && typeof timestamp === 'number') {\n    delta = timestamp - state.clock.elapsedTime;\n    state.clock.oldTime = state.clock.elapsedTime;\n    state.clock.elapsedTime = timestamp;\n  } // Call subscribers (useFrame)\n\n\n  for (i = 0; i < state.internal.subscribers.length; i++) {\n    state.internal.subscribers[i].ref.current(state, delta);\n  } // Render content\n\n\n  if (!state.internal.priority && state.gl.render) state.gl.render(state.scene, state.camera); // Decrease frame count\n\n  state.internal.frames = Math.max(0, state.internal.frames - 1);\n  return state.frameloop === 'always' ? 1 : state.internal.frames;\n}\n\nfunction createLoop(roots) {\n  var running = false;\n  var repeat;\n\n  function loop(timestamp) {\n    running = true;\n    repeat = 0; // Run effects\n\n    run(globalEffects, timestamp); // Render all roots\n\n    roots.forEach(function (root) {\n      var state = root.store.getState(); // If the frameloop is invalidated, do not run another frame\n\n      if (state.internal.active && (state.frameloop === 'always' || state.internal.frames > 0)) repeat += render$1(timestamp, state);\n    }); // Run after-effects\n\n    run(globalAfterEffects, timestamp); // Keep on looping if anything invalidates the frameloop\n\n    if (repeat > 0) return requestAnimationFrame(loop); // Tail call effects, they are called when rendering stops\n    else run(globalTailEffects, timestamp); // Flag end of operation\n\n    running = false;\n  }\n\n  function invalidate(state) {\n    if (!state) return roots.forEach(function (root) {\n      return invalidate(root.store.getState());\n    });\n    if (state.vr || !state.internal.active || state.frameloop === 'never') return; // Increase frames, do not go higher than 60\n\n    state.internal.frames = Math.min(60, state.internal.frames + 1); // If the render-loop isn't active, start it\n\n    if (!running) {\n      running = true;\n      requestAnimationFrame(loop);\n    }\n  }\n\n  function advance(timestamp) {\n    var runGlobalEffects = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    var state = arguments.length > 2 ? arguments[2] : undefined;\n    if (runGlobalEffects) run(globalEffects, timestamp);\n    if (!state) roots.forEach(function (root) {\n      return render$1(timestamp, root.store.getState());\n    });else render$1(timestamp, state);\n    if (runGlobalEffects) run(globalAfterEffects, timestamp);\n  }\n\n  return {\n    loop: loop,\n    invalidate: invalidate,\n    advance: advance\n  };\n}\n\nfunction createPointerEvents(store) {\n  var _createEvents = createEvents(store),\n      handlePointer = _createEvents.handlePointer;\n\n  var names = {\n    onClick: ['click', false],\n    onContextMenu: ['contextmenu', false],\n    onDoubleClick: ['dblclick', false],\n    onWheel: ['wheel', true],\n    onPointerDown: ['pointerdown', true],\n    onPointerUp: ['pointerup', true],\n    onPointerLeave: ['pointerleave', true],\n    onPointerMove: ['pointermove', true],\n    onPointerCancel: ['pointercancel', true],\n    onLostPointerCapture: ['lostpointercapture', true]\n  };\n  return {\n    connected: false,\n    handlers: Object.keys(names).reduce(function (acc, key) {\n      return _objectSpread(_objectSpread({}, acc), {}, _defineProperty({}, key, handlePointer(key)));\n    }, {}),\n    connect: function connect(target) {\n      var _events$handlers;\n\n      var _store$getState7 = store.getState(),\n          set = _store$getState7.set,\n          events = _store$getState7.events;\n\n      events.disconnect == null ? void 0 : events.disconnect();\n      set(function (state) {\n        return {\n          events: _objectSpread(_objectSpread({}, state.events), {}, {\n            connected: target\n          })\n        };\n      });\n      Object.entries((_events$handlers = events == null ? void 0 : events.handlers) != null ? _events$handlers : []).forEach(function (_ref13) {\n        var _ref14 = _slicedToArray(_ref13, 2),\n            name = _ref14[0],\n            event = _ref14[1];\n\n        var _names$name = _slicedToArray(names[name], 2),\n            eventName = _names$name[0],\n            passive = _names$name[1];\n\n        target.addEventListener(eventName, event, {\n          passive: passive\n        });\n      });\n    },\n    disconnect: function disconnect() {\n      var _store$getState8 = store.getState(),\n          set = _store$getState8.set,\n          events = _store$getState8.events;\n\n      if (events.connected) {\n        var _events$handlers2;\n\n        Object.entries((_events$handlers2 = events.handlers) != null ? _events$handlers2 : []).forEach(function (_ref15) {\n          var _ref16 = _slicedToArray(_ref15, 2),\n              name = _ref16[0],\n              event = _ref16[1];\n\n          if (events && events.connected instanceof HTMLElement) {\n            var _names$name2 = _slicedToArray(names[name], 1),\n                eventName = _names$name2[0];\n\n            events.connected.removeEventListener(eventName, event);\n          }\n        });\n        set(function (state) {\n          return {\n            events: _objectSpread(_objectSpread({}, state.events), {}, {\n              connected: false\n            })\n          };\n        });\n      }\n    }\n  };\n} // React currently throws a warning when using useLayoutEffect on the server.\n// To get around it, we can conditionally useEffect on the server (no-op) and\n// useLayoutEffect in the browser.\n\n\nvar useIsomorphicLayoutEffect = typeof window !== 'undefined' ? React.useLayoutEffect : React.useEffect;\n\nfunction Block(_ref17) {\n  var set = _ref17.set;\n  useIsomorphicLayoutEffect(function () {\n    set(new Promise(function () {\n      return null;\n    }));\n    return function () {\n      return set(false);\n    };\n  }, []);\n  return null;\n}\n\nvar ErrorBoundary = /*#__PURE__*/function (_React$Component) {\n  _inherits(ErrorBoundary, _React$Component);\n\n  var _super = _createSuper(ErrorBoundary);\n\n  function ErrorBoundary() {\n    var _this;\n\n    _classCallCheck(this, ErrorBoundary);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      error: false\n    };\n    return _this;\n  }\n\n  _createClass(ErrorBoundary, [{\n    key: \"componentDidCatch\",\n    value: function componentDidCatch(error) {\n      this.props.set(error);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return this.state.error ? null : this.props.children;\n    }\n  }]);\n\n  return ErrorBoundary;\n}(React.Component);\n\nErrorBoundary.getDerivedStateFromError = function () {\n  return {\n    error: true\n  };\n};\n\nfunction Canvas(_ref18) {\n  var children = _ref18.children,\n      fallback = _ref18.fallback,\n      tabIndex = _ref18.tabIndex,\n      resize = _ref18.resize,\n      id = _ref18.id,\n      style = _ref18.style,\n      className = _ref18.className,\n      events = _ref18.events,\n      props = _objectWithoutProperties(_ref18, _excluded5);\n\n  var _useMeasure = useMeasure(_objectSpread({\n    scroll: true,\n    debounce: {\n      scroll: 50,\n      resize: 0\n    }\n  }, resize)),\n      _useMeasure2 = _slicedToArray(_useMeasure, 2),\n      ref = _useMeasure2[0],\n      size = _useMeasure2[1];\n\n  var canvas = React.useRef(null);\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      block = _React$useState2[0],\n      setBlock = _React$useState2[1];\n\n  var _React$useState3 = React.useState(false),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      error = _React$useState4[0],\n      setError = _React$useState4[1]; // Suspend this component if block is a promise (2nd run)\n\n\n  if (block) throw block; // Throw exception outwards if anything within canvas throws\n\n  if (error) throw error; // Execute JSX in the reconciler as a layout-effect\n\n  useIsomorphicLayoutEffect(function () {\n    if (size.width > 0 && size.height > 0) {\n      render( /*#__PURE__*/React.createElement(ErrorBoundary, {\n        set: setError\n      }, /*#__PURE__*/React.createElement(React.Suspense, {\n        fallback: /*#__PURE__*/React.createElement(Block, {\n          set: setBlock\n        })\n      }, children)), canvas.current, _objectSpread(_objectSpread({}, props), {}, {\n        size: size,\n        events: events || createPointerEvents\n      }));\n    }\n  }, [size, children]);\n  useIsomorphicLayoutEffect(function () {\n    var container = canvas.current;\n    return function () {\n      return unmountComponentAtNode(container);\n    };\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: ref,\n    id: id,\n    className: className,\n    tabIndex: tabIndex,\n    style: _objectSpread({\n      position: 'relative',\n      width: '100%',\n      height: '100%',\n      overflow: 'hidden'\n    }, style)\n  }, /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: canvas,\n    style: {\n      display: 'block'\n    }\n  }, fallback));\n}\n\nfunction useThree() {\n  var selector = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function (state) {\n    return state;\n  };\n  var equalityFn = arguments.length > 1 ? arguments[1] : undefined;\n  var useStore = React.useContext(context);\n  if (!useStore) throw \"R3F hooks can only be used within the Canvas component!\";\n  return useStore(selector, equalityFn);\n}\n\nfunction useFrame(callback) {\n  var renderPriority = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var subscribe = React.useContext(context).getState().internal.subscribe; // Update ref\n\n  var ref = React.useRef(callback);\n  React.useLayoutEffect(function () {\n    return void (ref.current = callback);\n  }, [callback]); // Subscribe/unsub\n\n  React.useLayoutEffect(function () {\n    var unsubscribe = subscribe(ref, renderPriority);\n    return function () {\n      return unsubscribe();\n    };\n  }, [renderPriority, subscribe]);\n  return null;\n}\n\nfunction buildGraph(object) {\n  var data = {\n    nodes: {},\n    materials: {}\n  };\n\n  if (object) {\n    object.traverse(function (obj) {\n      if (obj.name) {\n        data.nodes[obj.name] = obj;\n      }\n\n      if (obj.material && !data.materials[obj.material.name]) {\n        data.materials[obj.material.name] = obj.material;\n      }\n    });\n  }\n\n  return data;\n}\n\nfunction useGraph(object) {\n  return React.useMemo(function () {\n    return buildGraph(object);\n  }, [object]);\n}\n\nfunction loadingFn(extensions, onProgress) {\n  return function (Proto) {\n    // Construct new loader and run extensions\n    var loader = new Proto();\n    if (extensions) extensions(loader); // Go through the urls and load them\n\n    for (var _len2 = arguments.length, input = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      input[_key2 - 1] = arguments[_key2];\n    }\n\n    return Promise.all(input.map(function (input) {\n      return new Promise(function (res, reject) {\n        return loader.load(input, function (data) {\n          if (data.scene) Object.assign(data, buildGraph(data.scene));\n          res(data);\n        }, onProgress, function (error) {\n          return reject(\"Could not load \".concat(input, \": \").concat(error.message));\n        });\n      });\n    }));\n  };\n}\n\nfunction useLoader(Proto, input, extensions, onProgress) {\n  // Use suspense to load async assets\n  var keys = Array.isArray(input) ? input : [input];\n  var results = useAsset.apply(void 0, [loadingFn(extensions, onProgress), Proto].concat(_toConsumableArray(keys))); // Return the object/s\n\n  return Array.isArray(input) ? results : results[0];\n}\n\nuseLoader.preload = function (Proto, input, extensions) {\n  var keys = Array.isArray(input) ? input : [input];\n  return useAsset.preload.apply(useAsset, [loadingFn(extensions), Proto].concat(_toConsumableArray(keys)));\n};\n\nvar roots = new Map();\nvar modes = ['legacy', 'blocking', 'concurrent'];\n\nvar _createLoop = createLoop(roots),\n    invalidate = _createLoop.invalidate,\n    advance = _createLoop.advance;\n\nvar _createRenderer = createRenderer(),\n    reconciler = _createRenderer.reconciler,\n    applyProps = _createRenderer.applyProps;\n\nvar createRendererInstance = function createRendererInstance(gl, canvas) {\n  return isRenderer(gl) ? gl : new THREE.WebGLRenderer(_objectSpread({\n    powerPreference: 'high-performance',\n    canvas: canvas,\n    antialias: true,\n    alpha: true\n  }, gl));\n};\n\nfunction render(element, canvas) {\n  var _ref19 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      gl = _ref19.gl,\n      size = _ref19.size,\n      _ref19$mode = _ref19.mode,\n      mode = _ref19$mode === void 0 ? modes[1] : _ref19$mode,\n      events = _ref19.events,\n      onCreated = _ref19.onCreated,\n      props = _objectWithoutProperties(_ref19, _excluded6);\n\n  var _store; // Allow size to take on container bounds initially\n\n\n  if (!size) {\n    var _canvas$parentElement, _canvas$parentElement2, _canvas$parentElement3, _canvas$parentElement4;\n\n    size = {\n      width: (_canvas$parentElement = (_canvas$parentElement2 = canvas.parentElement) == null ? void 0 : _canvas$parentElement2.clientWidth) != null ? _canvas$parentElement : 0,\n      height: (_canvas$parentElement3 = (_canvas$parentElement4 = canvas.parentElement) == null ? void 0 : _canvas$parentElement4.clientHeight) != null ? _canvas$parentElement3 : 0\n    };\n  }\n\n  var root = roots.get(canvas);\n  var fiber = root == null ? void 0 : root.fiber;\n  var store = root == null ? void 0 : root.store;\n  var state = (_store = store) == null ? void 0 : _store.getState();\n\n  if (fiber && state) {\n    var lastProps = state.internal.lastProps; // When a root was found, see if any fundamental props must be changed or exchanged\n    // Check pixelratio\n\n    if (props.dpr !== undefined && !is.equ(lastProps.dpr, props.dpr)) state.setDpr(props.dpr); // Check size\n\n    if (size !== undefined && !is.equ(lastProps.size, size)) state.setSize(size.width, size.height); // For some props we want to reset the entire root\n    // Changes to the color-space\n\n    var linearChanged = props.linear !== lastProps.linear;\n\n    if (linearChanged) {\n      unmountComponentAtNode(canvas);\n      fiber = undefined;\n    }\n  }\n\n  if (!fiber) {\n    // If no root has been found, make one\n    // Create gl\n    var glRenderer = createRendererInstance(gl, canvas); // Enable VR if requested\n\n    if (props.vr) {\n      glRenderer.xr.enabled = true;\n      glRenderer.setAnimationLoop(function (timestamp) {\n        return advance(timestamp, true);\n      });\n    } // Create store\n\n\n    store = createStore(applyProps, invalidate, advance, _objectSpread({\n      gl: glRenderer,\n      size: size\n    }, props));\n\n    var _state = store.getState();\n\n    _state.get; // Create renderer\n\n    fiber = reconciler.createContainer(store, modes.indexOf(mode), false, null); // Map it\n\n    roots.set(canvas, {\n      fiber: fiber,\n      store: store\n    }); // Store events internally\n\n    if (events) _state.set({\n      events: events(store)\n    });\n  }\n\n  if (store && fiber) {\n    reconciler.updateContainer( /*#__PURE__*/React.createElement(Provider, {\n      store: store,\n      element: element,\n      onCreated: onCreated,\n      target: canvas\n    }), fiber, null, function () {\n      return undefined;\n    });\n    return store;\n  } else {\n    throw 'Error creating root!';\n  }\n}\n\nfunction Provider(_ref20) {\n  var store = _ref20.store,\n      element = _ref20.element,\n      onCreated = _ref20.onCreated,\n      target = _ref20.target;\n  React.useEffect(function () {\n    var state = store.getState(); // Flag the canvas active, rendering will now begin\n\n    state.set(function (state) {\n      return {\n        internal: _objectSpread(_objectSpread({}, state.internal), {}, {\n          active: true\n        })\n      };\n    }); // Connect events\n\n    state.events.connect == null ? void 0 : state.events.connect(target); // Notifiy that init is completed, the scene graph exists, but nothing has yet rendered\n\n    if (onCreated) onCreated(state);\n  }, []);\n  return /*#__PURE__*/React.createElement(context.Provider, {\n    value: store\n  }, element);\n}\n\nfunction unmountComponentAtNode(canvas, callback) {\n  var root = roots.get(canvas);\n  var fiber = root == null ? void 0 : root.fiber;\n\n  if (fiber) {\n    var state = root == null ? void 0 : root.store.getState();\n    if (state) state.internal.active = false;\n    reconciler.updateContainer(null, fiber, null, function () {\n      if (state) {\n        setTimeout(function () {\n          var _state$gl, _state$gl$renderLists, _state$gl2;\n\n          state.events.disconnect == null ? void 0 : state.events.disconnect();\n          (_state$gl = state.gl) == null ? void 0 : (_state$gl$renderLists = _state$gl.renderLists) == null ? void 0 : _state$gl$renderLists.dispose == null ? void 0 : _state$gl$renderLists.dispose();\n          (_state$gl2 = state.gl) == null ? void 0 : _state$gl2.forceContextLoss == null ? void 0 : _state$gl2.forceContextLoss();\n          dispose(state);\n          roots.delete(canvas);\n          if (callback) callback(canvas);\n        }, 500);\n      }\n    });\n  }\n}\n\nfunction dispose(obj) {\n  if (obj.dispose && obj.type !== 'Scene') obj.dispose();\n\n  for (var p in obj) {\n    var _dispose, _ref;\n\n    (_dispose = (_ref = p).dispose) == null ? void 0 : _dispose.call(_ref);\n    delete obj[p];\n  }\n}\n\nvar act = reconciler.act;\nvar hasSymbol = is.fun(Symbol) && Symbol.for;\nvar REACT_PORTAL_TYPE = hasSymbol ? Symbol.for('react.portal') : 0xeaca;\n\nfunction createPortal(children, container, implementation) {\n  var key = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n  return {\n    $$typeof: REACT_PORTAL_TYPE,\n    key: key == null ? null : '' + key,\n    children: children,\n    containerInfo: prepare(container),\n    implementation: implementation\n  };\n}\n\nreconciler.injectIntoDevTools({\n  bundleType: process.env.NODE_ENV === 'production' ? 0 : 1,\n  rendererPackageName: '@react-three/fiber',\n  version: '17.0.2'\n});\nexport { Canvas, threeTypes as ReactThreeFiber, roots as _roots, act, addAfterEffect, addEffect, addTail, advance, applyProps, context, createPortal, dispose, createPointerEvents as events, extend, invalidate, reconciler, render, unmountComponentAtNode, useFrame, useGraph, useLoader, useThree };","map":{"version":3,"names":["THREE","React","create","shallow","Reconciler","unstable_now","unstable_runWithPriority","unstable_IdlePriority","useAsset","useMeasure","threeTypes","Object","freeze","__proto__","is","obj","a","arr","fun","str","num","und","Array","isArray","equ","b","i","makeId","event","eventObject","object","uuid","index","removeInteractivity","store","getState","internal","interaction","filter","o","initialHits","hovered","forEach","value","key","delete","createEvents","temp","Vector3","prepareRay","_raycaster$computeOff","state","raycaster","mouse","camera","size","computeOffsets","offsetX","offsetY","width","height","set","setFromCamera","calculateDistance","dx","initialClick","dy","Math","round","sqrt","filterPointerEvents","objects","some","name","_r3f$handlers","__r3f","handlers","intersect","enabled","seen","Set","intersections","eventsObjects","intersects","intersectObjects","item","id","has","add","_r3f","push","parent","patchIntersects","capturedMap","pointerId","get","values","handleIntersects","callback","length","unprojectedPoint","x","y","unproject","delta","type","releasePointerCapture","target","localState","stopped","hit","hasPointerCapture","_internal$capturedMap","_internal$capturedMap2","setPointerCapture","Map","extractEventProps","prop","getPrototypeOf","property","raycastEvent","spaceX","spaceY","ray","stopPropagation","capturesForPointer","from","find","higher","slice","indexOf","cancelPointer","currentTarget","sourceEvent","nativeEvent","hits","hoveredObj","data","onPointerOut","onPointerLeave","handlePointer","onPointerMissed","isPointerMove","undefined","onPointerOver","onPointerEnter","hoveredItem","onPointerMove","handler","includes","pointerMissed","map","_r3f$handlers2","isStore","def","getContainer","container","child","_container$__r3f$root","_container$__r3f","root","scene","DEFAULT","EMPTY","FILTER","catalogue","extend","prepare","instance","memoizedProps","createRenderer","roots","applyProps","newProps","oldProps","accumulative","_instance$__r3f","_root$getState","_instance$__r3f2","rootState","sameProps","newMemoizedProps","entries","entry","args","attach","objectKeys","keys","test","leftOvers","hasOwnProperty","toFilter","filteredProps","filteredPropsEntries","unshift","currentInstance","targetProp","split","reduce","acc","reverse","reverseEntries","constructor","defaultClassCall","dispose","copy","Layers","fromArray","isColor","Color","setScalar","mask","linear","convertSRGBToLinear","Texture","encoding","sRGBEncoding","invalidateInstance","raycast","splice","updateInstance","_instance$__r3f3","_instance$__r3f3$root","frames","invalidate","onUpdate","createInstance","hostContext","internalInstanceHandle","props","toUpperCase","fn","node","return","stateNode","containerInfo","isArgsArr","endsWith","appendChild","parentInstance","addedAsChild","attachArray","attachObject","isObject3D","insertBefore","beforeChild","added","array","dispatchEvent","restSiblings","children","sibling","removeRecursive","removeChild","_child$__r3f2","oldLength","newLength","_child$__r3f","remove","isInstance","shouldDispose","_child$__r3f3","switchInstance","fiber","newInstance","alternate","ref","current","reconciler","now","appendInitialChild","warnsIfNotActing","supportsMutation","isPrimaryRenderer","scheduleTimeout","setTimeout","cancelTimeout","clearTimeout","noTimeout","appendChildToContainer","removeChildFromContainer","insertInContainerBefore","commitUpdate","updatePayload","argsNew","restNew","argsOld","restOld","hasNewArgs","val","hideInstance","visible","unhideInstance","hideTextInstance","Error","getPublicInstance","getRootHostContext","rootContainer","getChildHostContext","parentHostContext","createTextInstance","finalizeInitialChildren","commitMount","prepareUpdate","shouldDeprioritizeSubtree","prepareForCommit","preparePortalMount","resetAfterCommit","shouldSetTextContent","clearContainer","isRenderer","render","isOrthographicCamera","context","createContext","createStore","advance","gl","shadows","flat","vr","orthographic","frameloop","dpr","performance","clock","Clock","raycastOptions","cameraOptions","shadowMap","assign","PCFSoftShadowMap","toneMapping","ACESFilmicToneMapping","outputEncoding","stop","elapsedTime","Raycaster","params","options","isCamera","Camera","OrthographicCamera","PerspectiveCamera","position","z","lookAt","setDpr","min","max","window","devicePixelRatio","initialDpr","defaultTarget","getCurrentViewport","aspect","distance","getWorldPosition","distanceTo","zoom","factor","fov","PI","h","tan","w","performanceTimeout","setPerformanceCurrent","timestamp","runGlobalEffects","Scene","Vector2","debounce","regress","viewport","setSize","events","connected","active","priority","lastProps","subscribers","subscribe","sort","s","left","right","top","bottom","updateProjectionMatrix","updateMatrixWorld","setPixelRatio","createSubs","subs","globalEffects","globalAfterEffects","globalTailEffects","addEffect","addAfterEffect","addTail","run","effects","render$1","getDelta","oldTime","createLoop","running","repeat","loop","requestAnimationFrame","createPointerEvents","names","onClick","onContextMenu","onDoubleClick","onWheel","onPointerDown","onPointerUp","onPointerCancel","onLostPointerCapture","connect","_events$handlers","disconnect","eventName","passive","addEventListener","_events$handlers2","HTMLElement","removeEventListener","useIsomorphicLayoutEffect","useLayoutEffect","useEffect","Block","Promise","ErrorBoundary","error","Component","getDerivedStateFromError","Canvas","fallback","tabIndex","resize","style","className","scroll","canvas","useRef","useState","block","setBlock","setError","createElement","Suspense","unmountComponentAtNode","overflow","display","useThree","selector","equalityFn","useStore","useContext","useFrame","renderPriority","unsubscribe","buildGraph","nodes","materials","traverse","material","useGraph","useMemo","loadingFn","extensions","onProgress","Proto","loader","input","all","res","reject","load","message","useLoader","results","preload","modes","createRendererInstance","WebGLRenderer","powerPreference","antialias","alpha","element","mode","onCreated","_store","_canvas$parentElement","_canvas$parentElement2","_canvas$parentElement3","_canvas$parentElement4","parentElement","clientWidth","clientHeight","linearChanged","glRenderer","xr","setAnimationLoop","createContainer","updateContainer","Provider","_state$gl","_state$gl$renderLists","_state$gl2","renderLists","forceContextLoss","p","_dispose","_ref","call","act","hasSymbol","Symbol","for","REACT_PORTAL_TYPE","createPortal","implementation","$$typeof","injectIntoDevTools","bundleType","process","env","NODE_ENV","rendererPackageName","version","ReactThreeFiber","_roots"],"sources":["C:/Users/Alex/Desktop/car/node_modules/@react-three/fiber/dist/react-three-fiber.esm.js"],"sourcesContent":["import * as THREE from 'three';\nimport * as React from 'react';\nimport create from 'zustand';\nimport shallow from 'zustand/shallow';\nimport Reconciler from 'react-reconciler';\nimport { unstable_now, unstable_runWithPriority, unstable_IdlePriority } from 'scheduler';\nimport { useAsset } from 'use-asset';\nimport useMeasure from 'react-use-measure';\n\nvar threeTypes = /*#__PURE__*/Object.freeze({\n  __proto__: null\n});\n\nconst is = {\n  obj: a => a === Object(a) && !is.arr(a) && typeof a !== 'function',\n  fun: a => typeof a === 'function',\n  str: a => typeof a === 'string',\n  num: a => typeof a === 'number',\n  und: a => a === void 0,\n  arr: a => Array.isArray(a),\n\n  equ(a, b) {\n    // Wrong type or one of the two undefined, doesn't match\n    if (typeof a !== typeof b || !!a !== !!b) return false; // Atomic, just compare a against b\n\n    if (is.str(a) || is.num(a) || is.obj(a)) return a === b; // Array, shallow compare first to see if it's a match\n\n    if (is.arr(a) && a == b) return true; // Last resort, go through keys\n\n    let i;\n\n    for (i in a) if (!(i in b)) return false;\n\n    for (i in b) if (a[i] !== b[i]) return false;\n\n    return is.und(i) ? a === b : true;\n  }\n\n};\n\nfunction makeId(event) {\n  return (event.eventObject || event.object).uuid + '/' + event.index;\n}\n\nfunction removeInteractivity(store, object) {\n  const {\n    internal\n  } = store.getState(); // Removes every trace of an object from the data store\n\n  internal.interaction = internal.interaction.filter(o => o !== object);\n  internal.initialHits = internal.initialHits.filter(o => o !== object);\n  internal.hovered.forEach((value, key) => {\n    if (value.eventObject === object || value.object === object) {\n      internal.hovered.delete(key);\n    }\n  });\n}\nfunction createEvents(store) {\n  const temp = new THREE.Vector3();\n  /** Sets up defaultRaycaster */\n\n  function prepareRay(event) {\n    var _raycaster$computeOff;\n\n    const state = store.getState();\n    const {\n      raycaster,\n      mouse,\n      camera,\n      size\n    } = state; // https://github.com/pmndrs/react-three-fiber/pull/782\n    // Events trigger outside of canvas when moved\n\n    const {\n      offsetX,\n      offsetY\n    } = (_raycaster$computeOff = raycaster.computeOffsets == null ? void 0 : raycaster.computeOffsets(event, state)) != null ? _raycaster$computeOff : event;\n    const {\n      width,\n      height\n    } = size;\n    mouse.set(offsetX / width * 2 - 1, -(offsetY / height) * 2 + 1);\n    raycaster.setFromCamera(mouse, camera);\n  }\n  /** Calculates delta */\n\n\n  function calculateDistance(event) {\n    const {\n      internal\n    } = store.getState();\n    const dx = event.offsetX - internal.initialClick[0];\n    const dy = event.offsetY - internal.initialClick[1];\n    return Math.round(Math.sqrt(dx * dx + dy * dy));\n  }\n  /** Returns true if an instance has a valid pointer-event registered, this excludes scroll, clicks etc */\n\n\n  function filterPointerEvents(objects) {\n    return objects.filter(obj => ['Move', 'Over', 'Enter', 'Out', 'Leave'].some(name => {\n      var _r3f$handlers;\n\n      return (_r3f$handlers = obj.__r3f.handlers) == null ? void 0 : _r3f$handlers['onPointer' + name];\n    }));\n  }\n\n  function intersect(filter) {\n    const state = store.getState();\n    const {\n      raycaster,\n      internal\n    } = state; // Skip event handling when noEvents is set\n\n    if (!raycaster.enabled) return [];\n    const seen = new Set();\n    const intersections = []; // Allow callers to eliminate event objects\n\n    const eventsObjects = filter ? filter(internal.interaction) : internal.interaction; // Intersect known handler objects and filter against duplicates\n\n    let intersects = raycaster.intersectObjects(eventsObjects, true).filter(item => {\n      const id = makeId(item);\n      if (seen.has(id)) return false;\n      seen.add(id);\n      return true;\n    }); // https://github.com/mrdoob/three.js/issues/16031\n    // Allow custom userland intersect sort order\n\n    if (raycaster.filter) intersects = raycaster.filter(intersects, state);\n\n    for (const intersect of intersects) {\n      let eventObject = intersect.object; // Bubble event up\n\n      while (eventObject) {\n        var _r3f;\n\n        const handlers = (_r3f = eventObject.__r3f) == null ? void 0 : _r3f.handlers;\n        if (handlers) intersections.push({ ...intersect,\n          eventObject\n        });\n        eventObject = eventObject.parent;\n      }\n    }\n\n    return intersections;\n  }\n  /**  Creates filtered intersects and returns an array of positive hits */\n\n\n  function patchIntersects(intersections, event) {\n    const {\n      internal\n    } = store.getState(); // If the interaction is captured, make all capturing targets  part of the\n    // intersect.\n\n    if ('pointerId' in event && internal.capturedMap.has(event.pointerId)) {\n      intersections.push(...internal.capturedMap.get(event.pointerId).values());\n    }\n\n    return intersections;\n  }\n  /**  Handles intersections by forwarding them to handlers */\n\n\n  function handleIntersects(intersections, event, callback) {\n    const {\n      raycaster,\n      mouse,\n      camera,\n      internal\n    } = store.getState(); // If anything has been found, forward it to the event listeners\n\n    if (intersections.length) {\n      const unprojectedPoint = temp.set(mouse.x, mouse.y, 0).unproject(camera);\n      const delta = event.type === 'click' ? calculateDistance(event) : 0;\n\n      const releasePointerCapture = id => event.target.releasePointerCapture(id);\n\n      const localState = {\n        stopped: false\n      };\n\n      for (const hit of intersections) {\n        const hasPointerCapture = id => {\n          var _internal$capturedMap, _internal$capturedMap2;\n\n          return (_internal$capturedMap = (_internal$capturedMap2 = internal.capturedMap.get(id)) == null ? void 0 : _internal$capturedMap2.has(hit.eventObject)) != null ? _internal$capturedMap : false;\n        };\n\n        const setPointerCapture = id => {\n          if (internal.capturedMap.has(id)) {\n            // if the pointerId was previously captured, we add the hit to the\n            // event capturedMap.\n            internal.capturedMap.get(id).set(hit.eventObject, hit);\n          } else {\n            // if the pointerId was not previously captured, we create a map\n            // containing the hitObject, and the hit. hitObject is used for\n            // faster access.\n            internal.capturedMap.set(id, new Map([[hit.eventObject, hit]]));\n          } // Call the original event now\n          event.target.setPointerCapture(id);\n        }; // Add native event props\n\n\n        let extractEventProps = {};\n\n        for (let prop in Object.getPrototypeOf(event)) {\n          let property = event[prop]; // Only copy over atomics, leave functions alone as these should be\n          // called as event.nativeEvent.fn()\n\n          if (typeof property !== 'function') extractEventProps[prop] = property;\n        }\n\n        let raycastEvent = { ...hit,\n          ...extractEventProps,\n          spaceX: mouse.x,\n          spaceY: mouse.y,\n          intersections,\n          stopped: localState.stopped,\n          delta,\n          unprojectedPoint,\n          ray: raycaster.ray,\n          camera: camera,\n          // Hijack stopPropagation, which just sets a flag\n          stopPropagation: () => {\n            // https://github.com/pmndrs/react-three-fiber/issues/596\n            // Events are not allowed to stop propagation if the pointer has been captured\n            const capturesForPointer = 'pointerId' in event && internal.capturedMap.get(event.pointerId); // We only authorize stopPropagation...\n\n            if ( // ...if this pointer hasn't been captured\n            !capturesForPointer || // ... or if the hit object is capturing the pointer\n            capturesForPointer.has(hit.eventObject)) {\n              raycastEvent.stopped = localState.stopped = true; // Propagation is stopped, remove all other hover records\n              // An event handler is only allowed to flush other handlers if it is hovered itself\n\n              if (internal.hovered.size && Array.from(internal.hovered.values()).find(i => i.eventObject === hit.eventObject)) {\n                // Objects cannot flush out higher up objects that have already caught the event\n                const higher = intersections.slice(0, intersections.indexOf(hit));\n                cancelPointer([...higher, hit]);\n              }\n            }\n          },\n          // there should be a distinction between target and currentTarget\n          target: {\n            hasPointerCapture,\n            setPointerCapture,\n            releasePointerCapture\n          },\n          currentTarget: {\n            hasPointerCapture,\n            setPointerCapture,\n            releasePointerCapture\n          },\n          sourceEvent: event,\n          // deprecated\n          nativeEvent: event\n        }; // Call subscribers\n\n        callback(raycastEvent); // Event bubbling may be interrupted by stopPropagation\n\n        if (localState.stopped === true) break;\n      }\n    }\n\n    return intersections;\n  }\n\n  function cancelPointer(hits) {\n    const {\n      internal\n    } = store.getState();\n    Array.from(internal.hovered.values()).forEach(hoveredObj => {\n      // When no objects were hit or the the hovered object wasn't found underneath the cursor\n      // we call onPointerOut and delete the object from the hovered-elements map\n      if (!hits.length || !hits.find(hit => hit.object === hoveredObj.object && hit.index === hoveredObj.index)) {\n        const eventObject = hoveredObj.eventObject;\n        const handlers = eventObject.__r3f.handlers;\n        internal.hovered.delete(makeId(hoveredObj));\n\n        if (handlers) {\n          // Clear out intersects, they are outdated by now\n          const data = { ...hoveredObj,\n            intersections: hits || []\n          };\n          handlers.onPointerOut == null ? void 0 : handlers.onPointerOut(data);\n          handlers.onPointerLeave == null ? void 0 : handlers.onPointerLeave(data);\n        }\n      }\n    });\n  }\n\n  const handlePointer = name => {\n    // Deal with cancelation\n    switch (name) {\n      case 'onPointerLeave':\n      case 'onPointerCancel':\n        return () => cancelPointer([]);\n\n      case 'onLostPointerCapture':\n        return event => {\n          if ('pointerId' in event) {\n            // this will be a problem if one target releases the pointerId\n            // and another one is still keeping it, as the line below\n            // indifferently deletes all capturing references.\n            store.getState().internal.capturedMap.delete(event.pointerId);\n          }\n\n          cancelPointer([]);\n        };\n    } // Any other pointer goes here ...\n\n\n    return event => {\n      const {\n        onPointerMissed,\n        internal\n      } = store.getState();\n      prepareRay(event); // Get fresh intersects\n\n      const isPointerMove = name === 'onPointerMove';\n      const filter = isPointerMove ? filterPointerEvents : undefined;\n      const hits = patchIntersects(intersect(filter), event); // Take care of unhover\n\n      if (isPointerMove) cancelPointer(hits);\n      handleIntersects(hits, event, data => {\n        const eventObject = data.eventObject;\n        const handlers = eventObject.__r3f.handlers; // Check presence of handlers\n\n        if (!handlers) return;\n\n        if (isPointerMove) {\n          // Move event ...\n          if (handlers.onPointerOver || handlers.onPointerEnter || handlers.onPointerOut || handlers.onPointerLeave) {\n            // When enter or out is present take care of hover-state\n            const id = makeId(data);\n            const hoveredItem = internal.hovered.get(id);\n\n            if (!hoveredItem) {\n              // If the object wasn't previously hovered, book it and call its handler\n              internal.hovered.set(id, data);\n              handlers.onPointerOver == null ? void 0 : handlers.onPointerOver(data);\n              handlers.onPointerEnter == null ? void 0 : handlers.onPointerEnter(data);\n            } else if (hoveredItem.stopped) {\n              // If the object was previously hovered and stopped, we shouldn't allow other items to proceed\n              data.stopPropagation();\n            }\n          } // Call mouse move\n\n\n          handlers.onPointerMove == null ? void 0 : handlers.onPointerMove(data);\n        } else {\n          // All other events ...\n          const handler = handlers == null ? void 0 : handlers[name];\n\n          if (handler) {\n            // Forward all events back to their respective handlers with the exception of click events,\n            // which must use the initial target\n            if (name !== 'onClick' && name !== 'onContextMenu' && name !== 'onDoubleClick' || internal.initialHits.includes(eventObject)) {\n              handler(data);\n              pointerMissed(event, internal.interaction.filter(object => object !== eventObject));\n            }\n          }\n        }\n      }); // Save initial coordinates on pointer-down\n\n      if (name === 'onPointerDown') {\n        internal.initialClick = [event.offsetX, event.offsetY];\n        internal.initialHits = hits.map(hit => hit.eventObject);\n      } // If a click yields no results, pass it back to the user as a miss\n\n\n      if ((name === 'onClick' || name === 'onContextMenu' || name === 'onDoubleClick') && !hits.length) {\n        if (calculateDistance(event) <= 2) {\n          pointerMissed(event, internal.interaction);\n          if (onPointerMissed) onPointerMissed(event);\n        }\n      }\n    };\n  };\n\n  function pointerMissed(event, objects) {\n    objects.forEach(object => {\n      var _r3f$handlers2;\n\n      return (_r3f$handlers2 = object.__r3f.handlers) == null ? void 0 : _r3f$handlers2.onPointerMissed == null ? void 0 : _r3f$handlers2.onPointerMissed(event);\n    });\n  }\n\n  return {\n    handlePointer\n  };\n}\n\n// Type guard to tell a store from a portal\nconst isStore = def => def && !!def.getState;\n\nconst getContainer = (container, child) => {\n  var _container$__r3f$root, _container$__r3f;\n\n  return {\n    // If the container is not a root-store then it must be a THREE.Object3D into which part of the\n    // scene is portalled into. Now there can be two variants of this, either that object is part of\n    // the regular jsx tree, in which case it already has __r3f with a valid root attached, or it lies\n    // outside react, in which case we must take the root of the child that is about to be attached to it.\n    root: isStore(container) ? container : (_container$__r3f$root = (_container$__r3f = container.__r3f) == null ? void 0 : _container$__r3f.root) != null ? _container$__r3f$root : child.__r3f.root,\n    // The container is the eventual target into which objects are mounted, it has to be a THREE.Object3D\n    container: isStore(container) ? container.getState().scene : container\n  };\n};\n\nconst DEFAULT = '__default';\nconst EMPTY = {};\nconst FILTER = ['children', 'key', 'ref'];\nlet catalogue = {};\n\nlet extend = objects => void (catalogue = { ...catalogue,\n  ...objects\n}); // Each object in the scene carries a small LocalState descriptor\n\n\nfunction prepare(object, state) {\n  const instance = object;\n\n  if (state != null && state.instance || !instance.__r3f) {\n    instance.__r3f = {\n      root: null,\n      memoizedProps: {},\n      objects: [],\n      ...state\n    };\n  }\n\n  return object;\n}\n\nfunction createRenderer(roots) {\n  function applyProps(instance, newProps, oldProps = {}, accumulative = false) {\n    var _instance$__r3f, _root$getState, _instance$__r3f2;\n\n    // Filter equals, events and reserved props\n    const localState = (_instance$__r3f = instance == null ? void 0 : instance.__r3f) != null ? _instance$__r3f : {};\n    const root = localState.root;\n    const rootState = (_root$getState = root == null ? void 0 : root.getState == null ? void 0 : root.getState()) != null ? _root$getState : {};\n    const sameProps = [];\n    const handlers = [];\n    const newMemoizedProps = {};\n    let i = 0;\n    Object.entries(newProps).forEach(([key, entry]) => {\n      // we don't want children, ref or key in the memoized props\n      if (FILTER.indexOf(key) === -1) {\n        newMemoizedProps[key] = entry;\n      }\n    });\n\n    if (localState.memoizedProps && localState.memoizedProps.args) {\n      newMemoizedProps.args = localState.memoizedProps.args;\n    }\n\n    if (localState.memoizedProps && localState.memoizedProps.attach) {\n      newMemoizedProps.attach = localState.memoizedProps.attach;\n    }\n\n    if (instance.__r3f) {\n      instance.__r3f.memoizedProps = newMemoizedProps;\n    }\n\n    let objectKeys = Object.keys(newProps);\n\n    for (i = 0; i < objectKeys.length; i++) {\n      if (is.equ(newProps[objectKeys[i]], oldProps[objectKeys[i]])) {\n        sameProps.push(objectKeys[i]);\n      } // Event-handlers ...\n      //   are functions, that\n      //   start with \"on\", and\n      //   contain the name \"Pointer\", \"Click\", \"DoubleClick\", \"ContextMenu\", or \"Wheel\"\n\n\n      if (is.fun(newProps[objectKeys[i]]) && /^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(objectKeys[i])) {\n        handlers.push(objectKeys[i]);\n      }\n    } // Catch props that existed, but now exist no more ...\n\n\n    const leftOvers = [];\n\n    if (accumulative) {\n      objectKeys = Object.keys(oldProps);\n\n      for (i = 0; i < objectKeys.length; i++) {\n        if (!newProps.hasOwnProperty(objectKeys[i])) {\n          leftOvers.push(objectKeys[i]);\n        }\n      }\n    }\n\n    const toFilter = [...sameProps, ...FILTER]; // Instances use \"object\" as a reserved identifier\n\n    if ((_instance$__r3f2 = instance.__r3f) != null && _instance$__r3f2.instance) toFilter.push('object');\n    const filteredProps = { ...newProps\n    }; // Removes sameProps and reserved props from newProps\n\n    objectKeys = Object.keys(filteredProps);\n\n    for (i = 0; i < objectKeys.length; i++) {\n      if (toFilter.indexOf(objectKeys[i]) > -1) {\n        delete filteredProps[objectKeys[i]];\n      }\n    } // Collect all new props\n\n\n    const filteredPropsEntries = Object.entries(filteredProps); // Prepend left-overs so they can be reset or removed\n    // Left-overs must come first!\n\n    for (i = 0; i < leftOvers.length; i++) {\n      if (leftOvers[i] !== 'children') {\n        filteredPropsEntries.unshift([leftOvers[i], DEFAULT + 'remove']);\n      }\n    }\n\n    if (filteredPropsEntries.length > 0) {\n      filteredPropsEntries.forEach(([key, value]) => {\n        if (!handlers.includes(key)) {\n          let currentInstance = instance;\n          let targetProp = currentInstance[key];\n\n          if (key.includes('-')) {\n            const entries = key.split('-');\n            targetProp = entries.reduce((acc, key) => acc[key], instance); // If the target is atomic, it forces us to switch the root\n\n            if (!(targetProp && targetProp.set)) {\n              const [name, ...reverseEntries] = entries.reverse();\n              currentInstance = reverseEntries.reverse().reduce((acc, key) => acc[key], instance);\n              key = name;\n            }\n          } // https://github.com/mrdoob/three.js/issues/21209\n          // HMR/fast-refresh relies on the ability to cancel out props, but threejs\n          // has no means to do this. Hence we curate a small collection of value-classes\n          // with their respective constructor/set arguments\n          // For removed props, try to set default values, if possible\n\n\n          if (value === DEFAULT + 'remove') {\n            if (targetProp && targetProp.constructor) {\n              // use the prop constructor to find the default it should be\n              value = new targetProp.constructor(newMemoizedProps.args);\n            } else if (currentInstance.constructor) {\n              // create a blank slate of the instance and copy the particular parameter.\n              // @ts-ignore\n              const defaultClassCall = new currentInstance.constructor(currentInstance.__r3f.memoizedProps.args);\n              value = defaultClassCall[targetProp]; // destory the instance\n\n              if (defaultClassCall.dispose) {\n                defaultClassCall.dispose();\n              }\n            } else {\n              // instance does not have constructor, just set it to 0\n              value = 0;\n            }\n          } // Special treatment for objects with support for set/copy, and layers\n\n\n          if (targetProp && targetProp.set && (targetProp.copy || targetProp instanceof THREE.Layers)) {\n            // If value is an array\n            if (Array.isArray(value)) {\n              if (targetProp.fromArray) {\n                targetProp.fromArray(value);\n              } else {\n                targetProp.set(...value);\n              }\n            } // Test again target.copy(class) next ...\n            else if (targetProp.copy && value && value.constructor && targetProp.constructor.name === value.constructor.name) {\n                targetProp.copy(value);\n              } // If nothing else fits, just set the single value, ignore undefined\n              // https://github.com/react-spring/react-three-fiber/issues/274\n              else if (value !== undefined) {\n                  const isColor = targetProp instanceof THREE.Color; // Allow setting array scalars\n\n                  if (!isColor && targetProp.setScalar) targetProp.setScalar(value); // Layers have no copy function, we must therefore copy the mask property\n                  else if (targetProp instanceof THREE.Layers && value instanceof THREE.Layers) targetProp.mask = value.mask; // Otherwise just set ...\n                    else targetProp.set(value); // Auto-convert sRGB colors, for now ...\n                  // https://github.com/react-spring/react-three-fiber/issues/344\n\n                  if (!rootState.linear && isColor) targetProp.convertSRGBToLinear();\n                } // Else, just overwrite the value\n\n          } else {\n            currentInstance[key] = value; // Auto-convert sRGB textures, for now ...\n            // https://github.com/react-spring/react-three-fiber/issues/344\n\n            if (!rootState.linear && currentInstance[key] instanceof THREE.Texture) currentInstance[key].encoding = THREE.sRGBEncoding;\n          }\n\n          invalidateInstance(instance);\n        }\n      }); // Preemptively delete the instance from the containers interaction\n\n      if (accumulative && root && instance.raycast && localState.handlers) {\n        localState.handlers = undefined;\n        const index = rootState.internal.interaction.indexOf(instance);\n        if (index > -1) rootState.internal.interaction.splice(index, 1);\n      } // Prep interaction handlers\n\n\n      if (handlers.length) {\n        if (accumulative && root && instance.raycast) {\n          rootState.internal.interaction.push(instance);\n        } // Add handlers to the instances handler-map\n\n\n        localState.handlers = handlers.reduce((acc, key) => ({ ...acc,\n          [key]: newProps[key]\n        }), {});\n      } // Call the update lifecycle when it is being updated, but only when it is part of the scene\n\n\n      if (instance.parent) updateInstance(instance);\n    }\n  }\n\n  function invalidateInstance(instance) {\n    var _instance$__r3f3, _instance$__r3f3$root;\n\n    const state = (_instance$__r3f3 = instance.__r3f) == null ? void 0 : (_instance$__r3f3$root = _instance$__r3f3.root) == null ? void 0 : _instance$__r3f3$root.getState == null ? void 0 : _instance$__r3f3$root.getState();\n    if (state && state.internal.frames === 0) state.invalidate();\n  }\n\n  function updateInstance(instance) {\n    instance.onUpdate == null ? void 0 : instance.onUpdate(instance);\n  }\n\n  function createInstance(type, {\n    args = [],\n    ...props\n  }, root, hostContext, internalInstanceHandle) {\n    let name = `${type[0].toUpperCase()}${type.slice(1)}`;\n    let instance; // https://github.com/facebook/react/issues/17147\n    // Portals do not give us a root, they are themselves treated as a root by the reconciler\n    // In order to figure out the actual root we have to climb through fiber internals :(\n\n    if (!isStore(root) && internalInstanceHandle) {\n      const fn = node => {\n        if (!node.return) return node.stateNode && node.stateNode.containerInfo;else return fn(node.return);\n      };\n\n      root = fn(internalInstanceHandle);\n    } // Assert that by now we have a valid root\n\n\n    if (!root || !isStore(root)) throw `No valid root for ${name}!`;\n\n    if (type === 'primitive') {\n      if (props.object === undefined) throw `Primitives without 'object' are invalid!`;\n      const object = props.object;\n      instance = prepare(object, {\n        root,\n        instance: true\n      });\n    } else {\n      const target = catalogue[name] || THREE[name];\n      if (!target) throw `${name} is not part of the THREE namespace! Did you forget to extend? See: https://github.com/pmndrs/react-three-fiber/blob/master/markdown/api.md#using-3rd-party-objects-declaratively`;\n      const isArgsArr = is.arr(args); // Instanciate new object, link it to the root\n\n      instance = prepare(isArgsArr ? new target(...args) : new target(args), {\n        root,\n        // append memoized props with args so it's not forgotten\n        memoizedProps: {\n          args: isArgsArr && args.length === 0 ? null : args\n        }\n      });\n    } // Auto-attach geometries and materials\n\n\n    if (name.endsWith('Geometry')) {\n      props = {\n        attach: 'geometry',\n        ...props\n      };\n    } else if (name.endsWith('Material')) {\n      props = {\n        attach: 'material',\n        ...props\n      };\n    } // It should NOT call onUpdate on object instanciation, because it hasn't been added to the\n    // view yet. If the callback relies on references for instance, they won't be ready yet, this is\n    // why it passes \"true\" here\n\n\n    applyProps(instance, props, {});\n    return instance;\n  }\n\n  function appendChild(parentInstance, child) {\n    let addedAsChild = false;\n\n    if (child) {\n      // The attach attribute implies that the object attaches itself on the parent\n      if (child.attachArray) {\n        if (!is.arr(parentInstance[child.attachArray])) parentInstance[child.attachArray] = [];\n        parentInstance[child.attachArray].push(child);\n      } else if (child.attachObject) {\n        if (!is.obj(parentInstance[child.attachObject[0]])) parentInstance[child.attachObject[0]] = {};\n        parentInstance[child.attachObject[0]][child.attachObject[1]] = child;\n      } else if (child.attach && !is.fun(child.attach)) {\n        parentInstance[child.attach] = child;\n      } else if (child.isObject3D) {\n        // add in the usual parent-child way\n        parentInstance.add(child);\n        addedAsChild = true;\n      }\n\n      if (!addedAsChild) {\n        // This is for anything that used attach, and for non-Object3Ds that don't get attached to props;\n        // that is, anything that's a child in React but not a child in the scenegraph.\n        parentInstance.__r3f.objects.push(child);\n\n        child.parent = parentInstance;\n      }\n\n      updateInstance(child);\n      invalidateInstance(child);\n    }\n  }\n\n  function insertBefore(parentInstance, child, beforeChild) {\n    let added = false;\n\n    if (child) {\n      if (child.attachArray) {\n        const array = parentInstance[child.attachArray];\n        if (!is.arr(array)) parentInstance[child.attachArray] = [];\n        array.splice(array.indexOf(beforeChild), 0, child);\n      } else if (child.attachObject || child.attach && !is.fun(child.attach)) {\n        // attach and attachObject don't have an order anyway, so just append\n        added = true;\n        return appendChild(parentInstance, child);\n      } else if (child.isObject3D) {\n        child.parent = parentInstance;\n        child.dispatchEvent({\n          type: 'added'\n        });\n        const restSiblings = parentInstance.children.filter(sibling => sibling !== child);\n        const index = restSiblings.indexOf(beforeChild);\n        parentInstance.children = [...restSiblings.slice(0, index), child, ...restSiblings.slice(index)];\n        added = true;\n      }\n\n      if (!added) {\n        parentInstance.__r3f.objects.push(child);\n\n        child.parent = parentInstance;\n      }\n\n      updateInstance(child);\n      invalidateInstance(child);\n    }\n  }\n\n  function removeRecursive(array, parent, dispose = false) {\n    if (array) [...array].forEach(child => removeChild(parent, child, dispose));\n  }\n\n  function removeChild(parentInstance, child, dispose) {\n    if (child) {\n      var _child$__r3f2;\n\n      if (parentInstance.__r3f.objects) {\n        const oldLength = parentInstance.__r3f.objects.length;\n        parentInstance.__r3f.objects = parentInstance.__r3f.objects.filter(x => x !== child);\n        const newLength = parentInstance.__r3f.objects.length; // was it in the list?\n\n        if (newLength < oldLength) {\n          // we had also set this, so we must clear it now\n          child.parent = null;\n        }\n      } // Remove attachment\n\n\n      if (child.attachArray) {\n        parentInstance[child.attachArray] = parentInstance[child.attachArray].filter(x => x !== child);\n      } else if (child.attachObject) {\n        delete parentInstance[child.attachObject[0]][child.attachObject[1]];\n      } else if (child.attach && !is.fun(child.attach)) {\n        parentInstance[child.attach] = null;\n      } else if (child.isObject3D) {\n        var _child$__r3f;\n\n        parentInstance.remove(child); // Remove interactivity\n\n        if ((_child$__r3f = child.__r3f) != null && _child$__r3f.root) {\n          removeInteractivity(child.__r3f.root, child);\n        }\n      } // Allow objects to bail out of recursive dispose alltogether by passing dispose={null}\n      // Never dispose of primitives because their state may be kept outside of React!\n      // In order for an object to be able to dispose it has to have\n      //   - a dispose method,\n      //   - it cannot be an <instance object={...} />\n      //   - it cannot be a THREE.Scene, because three has broken it's own api\n      //\n      // Since disposal is recursive, we can check the optional dispose arg, which will be undefined\n      // when the reconciler calls it, but then carry our own check recursively\n\n\n      const isInstance = (_child$__r3f2 = child.__r3f) == null ? void 0 : _child$__r3f2.instance;\n      const shouldDispose = dispose === undefined ? child.dispose !== null && !isInstance : dispose; // Remove nested child objects. Primitives should not have objects and children that are\n      // attached to them declaratively ...\n\n      if (!isInstance) {\n        var _child$__r3f3;\n\n        removeRecursive((_child$__r3f3 = child.__r3f) == null ? void 0 : _child$__r3f3.objects, child, shouldDispose);\n        removeRecursive(child.children, child, shouldDispose);\n      } // Remove references\n\n\n      if (child.__r3f) {\n        delete child.__r3f.root;\n        delete child.__r3f.objects;\n        delete child.__r3f.handlers;\n        delete child.__r3f.memoizedProps;\n        if (!isInstance) delete child.__r3f;\n      } // Dispose item whenever the reconciler feels like it\n\n\n      if (shouldDispose && child.dispose && child.type !== 'Scene') {\n        unstable_runWithPriority(unstable_IdlePriority, () => child.dispose());\n      }\n\n      invalidateInstance(parentInstance);\n    }\n  }\n\n  function switchInstance(instance, type, newProps, fiber) {\n    const parent = instance.parent;\n    if (!parent) return;\n    const newInstance = createInstance(type, newProps, instance.__r3f.root); // https://github.com/pmndrs/react-three-fiber/issues/1348\n    // When args change the instance has to be re-constructed, which then\n    // forces r3f to re-parent the children and non-scene objects\n\n    if (instance.children) {\n      instance.children.forEach(child => appendChild(newInstance, child));\n      instance.children = [];\n    }\n\n    instance.__r3f.objects.forEach(child => appendChild(newInstance, child));\n\n    instance.__r3f.objects = [];\n    removeChild(parent, instance);\n    appendChild(parent, newInstance) // This evil hack switches the react-internal fiber node\n    // https://github.com/facebook/react/issues/14983\n    // https://github.com/facebook/react/pull/15021\n    ;\n    [fiber, fiber.alternate].forEach(fiber => {\n      if (fiber !== null) {\n        fiber.stateNode = newInstance;\n\n        if (fiber.ref) {\n          if (typeof fiber.ref === 'function') fiber.ref(newInstance);else fiber.ref.current = newInstance;\n        }\n      }\n    });\n  }\n\n  const reconciler = Reconciler({\n    now: unstable_now,\n    createInstance,\n    removeChild,\n    appendChild,\n    appendInitialChild: appendChild,\n    insertBefore,\n    warnsIfNotActing: true,\n    supportsMutation: true,\n    isPrimaryRenderer: false,\n    // @ts-ignore\n    scheduleTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n    // @ts-ignore\n    cancelTimeout: is.fun(clearTimeout) ? clearTimeout : undefined,\n    // @ts-ignore\n    setTimeout: is.fun(setTimeout) ? setTimeout : undefined,\n    // @ts-ignore\n    clearTimeout: is.fun(clearTimeout) ? clearTimeout : undefined,\n    noTimeout: -1,\n    appendChildToContainer: (parentInstance, child) => {\n      const {\n        container,\n        root\n      } = getContainer(parentInstance, child); // Link current root to the default scene\n\n      container.__r3f.root = root;\n      appendChild(container, child);\n    },\n    removeChildFromContainer: (parentInstance, child) => {\n      const {\n        container\n      } = getContainer(parentInstance, child);\n      removeChild(container, child);\n    },\n    insertInContainerBefore: (parentInstance, child, beforeChild) => {\n      const {\n        container\n      } = getContainer(parentInstance, child);\n      insertBefore(container, child, beforeChild);\n    },\n\n    commitUpdate(instance, updatePayload, type, oldProps, newProps, fiber) {\n      if (instance.__r3f.instance && newProps.object && newProps.object !== instance) {\n        // <instance object={...} /> where the object reference has changed\n        switchInstance(instance, type, newProps, fiber);\n      } else {\n        // This is a data object, let's extract critical information about it\n        const {\n          args: argsNew = [],\n          ...restNew\n        } = newProps;\n        const {\n          args: argsOld = [],\n          ...restOld\n        } = oldProps; // If it has new props or arguments, then it needs to be re-instanciated\n\n        const hasNewArgs = argsNew.some((value, index) => is.obj(value) ? Object.entries(value).some(([key, val]) => val !== argsOld[index][key]) : value !== argsOld[index]);\n\n        if (hasNewArgs) {\n          // Next we create a new instance and append it again\n          switchInstance(instance, type, newProps, fiber);\n        } else {\n          // Otherwise just overwrite props\n          applyProps(instance, restNew, restOld, true);\n        }\n      }\n    },\n\n    hideInstance(instance) {\n      if (instance.isObject3D) {\n        instance.visible = false;\n        invalidateInstance(instance);\n      }\n    },\n\n    unhideInstance(instance, props) {\n      if (instance.isObject3D && props.visible == null || props.visible) {\n        instance.visible = true;\n        invalidateInstance(instance);\n      }\n    },\n\n    hideTextInstance() {\n      throw new Error('Text is not allowed in the R3F tree.');\n    },\n\n    getPublicInstance(instance) {\n      // TODO: might fix switchInstance (?)\n      return instance;\n    },\n\n    getRootHostContext(rootContainer) {\n      return EMPTY;\n    },\n\n    getChildHostContext(parentHostContext) {\n      return EMPTY;\n    },\n\n    createTextInstance() {},\n\n    finalizeInitialChildren(instance) {\n      // https://github.com/facebook/react/issues/20271\n      // Returning true will trigger commitMount\n      return !!instance.__r3f.handlers;\n    },\n\n    commitMount(instance)\n    /*, type, props*/\n    {\n      // https://github.com/facebook/react/issues/20271\n      // This will make sure events are only added once to the central container\n      if (instance.raycast && instance.__r3f.handlers) instance.__r3f.root.getState().internal.interaction.push(instance);\n    },\n\n    prepareUpdate() {\n      return EMPTY;\n    },\n\n    shouldDeprioritizeSubtree() {\n      return false;\n    },\n\n    prepareForCommit() {\n      return null;\n    },\n\n    preparePortalMount(...args) {// noop\n    },\n\n    resetAfterCommit() {// noop\n    },\n\n    shouldSetTextContent() {\n      return false;\n    },\n\n    clearContainer() {\n      return false;\n    }\n\n  });\n  return {\n    reconciler,\n    applyProps\n  };\n}\n\nconst isRenderer = def => def && !!def.render;\nconst isOrthographicCamera = def => def && def.isOrthographicCamera;\nconst context = /*#__PURE__*/React.createContext(null);\n\nconst createStore = (applyProps, invalidate, advance, props) => {\n  const {\n    gl,\n    size,\n    shadows = false,\n    linear = false,\n    flat = false,\n    vr = false,\n    orthographic = false,\n    frameloop = 'always',\n    dpr = 1,\n    performance,\n    clock = new THREE.Clock(),\n    raycaster: raycastOptions,\n    camera: cameraOptions,\n    onPointerMissed\n  } = props; // Set shadowmap\n\n  if (shadows) {\n    gl.shadowMap.enabled = true;\n    if (typeof shadows === 'object') Object.assign(gl.shadowMap, shadows);else gl.shadowMap.type = THREE.PCFSoftShadowMap;\n  } // Set color management\n\n\n  if (!linear) {\n    if (!flat) gl.toneMapping = THREE.ACESFilmicToneMapping;\n    gl.outputEncoding = THREE.sRGBEncoding;\n  } // clock.elapsedTime is updated using advance(timestamp)\n\n\n  if (frameloop === 'never') {\n    clock.stop();\n    clock.elapsedTime = 0;\n  }\n\n  const rootState = create((set, get) => {\n    // Create custom raycaster\n    const raycaster = new THREE.Raycaster();\n    const {\n      params,\n      ...options\n    } = raycastOptions || {};\n    applyProps(raycaster, {\n      enabled: true,\n      ...options,\n      params: { ...raycaster.params,\n        ...params\n      }\n    }, {}); // Create default camera\n\n    const isCamera = cameraOptions instanceof THREE.Camera;\n    const camera = isCamera ? cameraOptions : orthographic ? new THREE.OrthographicCamera(0, 0, 0, 0, 0.1, 1000) : new THREE.PerspectiveCamera(75, 0, 0.1, 1000);\n\n    if (!isCamera) {\n      camera.position.z = 5;\n      if (cameraOptions) applyProps(camera, cameraOptions, {}); // Always look at center by default\n\n      camera.lookAt(0, 0, 0);\n    }\n\n    function setDpr(dpr) {\n      return Array.isArray(dpr) ? Math.min(Math.max(dpr[0], window.devicePixelRatio), dpr[1]) : dpr;\n    }\n\n    const initialDpr = setDpr(dpr);\n    const position = new THREE.Vector3();\n    const defaultTarget = new THREE.Vector3();\n\n    function getCurrentViewport(camera = get().camera, target = defaultTarget, size = get().size) {\n      const {\n        width,\n        height\n      } = size;\n      const aspect = width / height;\n      const distance = camera.getWorldPosition(position).distanceTo(target);\n\n      if (isOrthographicCamera(camera)) {\n        return {\n          width: width / camera.zoom,\n          height: height / camera.zoom,\n          factor: 1,\n          distance,\n          aspect\n        };\n      } else {\n        const fov = camera.fov * Math.PI / 180; // convert vertical fov to radians\n\n        const h = 2 * Math.tan(fov / 2) * distance; // visible height\n\n        const w = h * (width / height);\n        return {\n          width: w,\n          height: h,\n          factor: width / w,\n          distance,\n          aspect\n        };\n      }\n    }\n\n    let performanceTimeout = undefined;\n\n    const setPerformanceCurrent = current => set(state => ({\n      performance: { ...state.performance,\n        current\n      }\n    }));\n\n    return {\n      gl,\n      set,\n      get,\n      invalidate: () => invalidate(get()),\n      advance: (timestamp, runGlobalEffects) => advance(timestamp, runGlobalEffects, get()),\n      linear,\n      flat,\n      scene: prepare(new THREE.Scene()),\n      camera,\n      raycaster,\n      clock,\n      mouse: new THREE.Vector2(),\n      vr,\n      frameloop,\n      onPointerMissed,\n      performance: {\n        current: 1,\n        min: 0.5,\n        max: 1,\n        debounce: 200,\n        ...performance,\n        regress: () => {\n          const state = get(); // Clear timeout\n\n          if (performanceTimeout) clearTimeout(performanceTimeout); // Set lower bound performance\n\n          if (state.performance.current !== state.performance.min) setPerformanceCurrent(state.performance.min); // Go back to upper bound performance after a while unless something regresses meanwhile\n\n          performanceTimeout = setTimeout(() => setPerformanceCurrent(get().performance.max), state.performance.debounce);\n        }\n      },\n      size: {\n        width: 0,\n        height: 0\n      },\n      viewport: {\n        initialDpr,\n        dpr: initialDpr,\n        width: 0,\n        height: 0,\n        aspect: 0,\n        distance: 0,\n        factor: 0,\n        getCurrentViewport\n      },\n      setSize: (width, height) => {\n        const size = {\n          width,\n          height\n        };\n        set(state => ({\n          size,\n          viewport: { ...state.viewport,\n            ...getCurrentViewport(camera, defaultTarget, size)\n          }\n        }));\n      },\n      setDpr: dpr => set(state => ({\n        viewport: { ...state.viewport,\n          dpr: setDpr(dpr)\n        }\n      })),\n      events: {\n        connected: false\n      },\n      internal: {\n        active: false,\n        priority: 0,\n        frames: 0,\n        lastProps: props,\n        interaction: [],\n        hovered: new Map(),\n        subscribers: [],\n        initialClick: [0, 0],\n        initialHits: [],\n        capturedMap: new Map(),\n        subscribe: (ref, priority = 0) => {\n          set(({\n            internal\n          }) => ({\n            internal: { ...internal,\n              // If this subscription was given a priority, it takes rendering into its own hands\n              // For that reason we switch off automatic rendering and increase the manual flag\n              // As long as this flag is positive (there could be multiple render subscription)\n              // ..there can be no internal rendering at all\n              priority: internal.priority + (priority ? 1 : 0),\n              // Register subscriber and sort layers from lowest to highest, meaning,\n              // highest priority renders last (on top of the other frames)\n              subscribers: [...internal.subscribers, {\n                ref,\n                priority\n              }].sort((a, b) => a.priority - b.priority)\n            }\n          }));\n          return () => {\n            set(({\n              internal\n            }) => ({\n              internal: { ...internal,\n                // Decrease manual flag if this subscription had a priority\n                priority: internal.priority - (priority ? 1 : 0),\n                // Remove subscriber from list\n                subscribers: internal.subscribers.filter(s => s.ref !== ref)\n              }\n            }));\n          };\n        }\n      }\n    };\n  }); // Resize camera and renderer on changes to size and pixelratio\n\n  rootState.subscribe(() => {\n    const {\n      camera,\n      size,\n      viewport,\n      internal\n    } = rootState.getState(); // https://github.com/pmndrs/react-three-fiber/issues/92\n    // Do not mess with the camera if it belongs to the user\n\n    if (!(internal.lastProps.camera instanceof THREE.Camera)) {\n      if (isOrthographicCamera(camera)) {\n        camera.left = size.width / -2;\n        camera.right = size.width / 2;\n        camera.top = size.height / 2;\n        camera.bottom = size.height / -2;\n      } else {\n        camera.aspect = size.width / size.height;\n      }\n\n      camera.updateProjectionMatrix(); // https://github.com/pmndrs/react-three-fiber/issues/178\n      // Update matrix world since the renderer is a frame late\n\n      camera.updateMatrixWorld();\n    } // Update renderer\n\n\n    gl.setPixelRatio(viewport.dpr);\n    gl.setSize(size.width, size.height);\n  }, state => [state.viewport.dpr, state.size], shallow);\n  const state = rootState.getState(); // Update size\n\n  if (size) state.setSize(size.width, size.height); // Invalidate on any change\n\n  rootState.subscribe(state => invalidate(state)); // Return root state\n\n  return rootState;\n};\n\nfunction createSubs(callback, subs) {\n  const index = subs.length;\n  subs.push(callback);\n  return () => void subs.splice(index, 1);\n}\n\nlet i;\nlet globalEffects = [];\nlet globalAfterEffects = [];\nlet globalTailEffects = [];\nconst addEffect = callback => createSubs(callback, globalEffects);\nconst addAfterEffect = callback => createSubs(callback, globalAfterEffects);\nconst addTail = callback => createSubs(callback, globalTailEffects);\n\nfunction run(effects, timestamp) {\n  for (i = 0; i < effects.length; i++) effects[i](timestamp);\n}\n\nfunction render$1(timestamp, state) {\n  // Run local effects\n  let delta = state.clock.getDelta(); // In frameloop='never' mode, clock times are updated using the provided timestamp\n\n  if (state.frameloop === 'never' && typeof timestamp === 'number') {\n    delta = timestamp - state.clock.elapsedTime;\n    state.clock.oldTime = state.clock.elapsedTime;\n    state.clock.elapsedTime = timestamp;\n  } // Call subscribers (useFrame)\n\n\n  for (i = 0; i < state.internal.subscribers.length; i++) state.internal.subscribers[i].ref.current(state, delta); // Render content\n\n\n  if (!state.internal.priority && state.gl.render) state.gl.render(state.scene, state.camera); // Decrease frame count\n\n  state.internal.frames = Math.max(0, state.internal.frames - 1);\n  return state.frameloop === 'always' ? 1 : state.internal.frames;\n}\n\nfunction createLoop(roots) {\n  let running = false;\n  let repeat;\n\n  function loop(timestamp) {\n    running = true;\n    repeat = 0; // Run effects\n\n    run(globalEffects, timestamp); // Render all roots\n\n    roots.forEach(root => {\n      const state = root.store.getState(); // If the frameloop is invalidated, do not run another frame\n\n      if (state.internal.active && (state.frameloop === 'always' || state.internal.frames > 0)) repeat += render$1(timestamp, state);\n    }); // Run after-effects\n\n    run(globalAfterEffects, timestamp); // Keep on looping if anything invalidates the frameloop\n\n    if (repeat > 0) return requestAnimationFrame(loop); // Tail call effects, they are called when rendering stops\n    else run(globalTailEffects, timestamp); // Flag end of operation\n\n    running = false;\n  }\n\n  function invalidate(state) {\n    if (!state) return roots.forEach(root => invalidate(root.store.getState()));\n    if (state.vr || !state.internal.active || state.frameloop === 'never') return; // Increase frames, do not go higher than 60\n\n    state.internal.frames = Math.min(60, state.internal.frames + 1); // If the render-loop isn't active, start it\n\n    if (!running) {\n      running = true;\n      requestAnimationFrame(loop);\n    }\n  }\n\n  function advance(timestamp, runGlobalEffects = true, state) {\n    if (runGlobalEffects) run(globalEffects, timestamp);\n    if (!state) roots.forEach(root => render$1(timestamp, root.store.getState()));else render$1(timestamp, state);\n    if (runGlobalEffects) run(globalAfterEffects, timestamp);\n  }\n\n  return {\n    loop,\n    invalidate,\n    advance\n  };\n}\n\nfunction createPointerEvents(store) {\n  const {\n    handlePointer\n  } = createEvents(store);\n  const names = {\n    onClick: ['click', false],\n    onContextMenu: ['contextmenu', false],\n    onDoubleClick: ['dblclick', false],\n    onWheel: ['wheel', true],\n    onPointerDown: ['pointerdown', true],\n    onPointerUp: ['pointerup', true],\n    onPointerLeave: ['pointerleave', true],\n    onPointerMove: ['pointermove', true],\n    onPointerCancel: ['pointercancel', true],\n    onLostPointerCapture: ['lostpointercapture', true]\n  };\n  return {\n    connected: false,\n    handlers: Object.keys(names).reduce((acc, key) => ({ ...acc,\n      [key]: handlePointer(key)\n    }), {}),\n    connect: target => {\n      var _events$handlers;\n\n      const {\n        set,\n        events\n      } = store.getState();\n      events.disconnect == null ? void 0 : events.disconnect();\n      set(state => ({\n        events: { ...state.events,\n          connected: target\n        }\n      }));\n      Object.entries((_events$handlers = events == null ? void 0 : events.handlers) != null ? _events$handlers : []).forEach(([name, event]) => {\n        const [eventName, passive] = names[name];\n        target.addEventListener(eventName, event, {\n          passive\n        });\n      });\n    },\n    disconnect: () => {\n      const {\n        set,\n        events\n      } = store.getState();\n\n      if (events.connected) {\n        var _events$handlers2;\n\n        Object.entries((_events$handlers2 = events.handlers) != null ? _events$handlers2 : []).forEach(([name, event]) => {\n          if (events && events.connected instanceof HTMLElement) {\n            const [eventName] = names[name];\n            events.connected.removeEventListener(eventName, event);\n          }\n        });\n        set(state => ({\n          events: { ...state.events,\n            connected: false\n          }\n        }));\n      }\n    }\n  };\n}\n\n// React currently throws a warning when using useLayoutEffect on the server.\n// To get around it, we can conditionally useEffect on the server (no-op) and\n// useLayoutEffect in the browser.\nconst useIsomorphicLayoutEffect = typeof window !== 'undefined' ? React.useLayoutEffect : React.useEffect;\n\nfunction Block({\n  set\n}) {\n  useIsomorphicLayoutEffect(() => {\n    set(new Promise(() => null));\n    return () => set(false);\n  }, []);\n  return null;\n}\n\nclass ErrorBoundary extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      error: false\n    };\n  }\n\n  componentDidCatch(error) {\n    this.props.set(error);\n  }\n\n  render() {\n    return this.state.error ? null : this.props.children;\n  }\n\n}\n\nErrorBoundary.getDerivedStateFromError = () => ({\n  error: true\n});\n\nfunction Canvas({\n  children,\n  fallback,\n  tabIndex,\n  resize,\n  id,\n  style,\n  className,\n  events,\n  ...props\n}) {\n  const [ref, size] = useMeasure({\n    scroll: true,\n    debounce: {\n      scroll: 50,\n      resize: 0\n    },\n    ...resize\n  });\n  const canvas = React.useRef(null);\n  const [block, setBlock] = React.useState(false);\n  const [error, setError] = React.useState(false); // Suspend this component if block is a promise (2nd run)\n\n  if (block) throw block; // Throw exception outwards if anything within canvas throws\n\n  if (error) throw error; // Execute JSX in the reconciler as a layout-effect\n\n  useIsomorphicLayoutEffect(() => {\n    if (size.width > 0 && size.height > 0) {\n      render( /*#__PURE__*/React.createElement(ErrorBoundary, {\n        set: setError\n      }, /*#__PURE__*/React.createElement(React.Suspense, {\n        fallback: /*#__PURE__*/React.createElement(Block, {\n          set: setBlock\n        })\n      }, children)), canvas.current, { ...props,\n        size,\n        events: events || createPointerEvents\n      });\n    }\n  }, [size, children]);\n  useIsomorphicLayoutEffect(() => {\n    const container = canvas.current;\n    return () => unmountComponentAtNode(container);\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: ref,\n    id: id,\n    className: className,\n    tabIndex: tabIndex,\n    style: {\n      position: 'relative',\n      width: '100%',\n      height: '100%',\n      overflow: 'hidden',\n      ...style\n    }\n  }, /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: canvas,\n    style: {\n      display: 'block'\n    }\n  }, fallback));\n}\n\nfunction useThree(selector = state => state, equalityFn) {\n  const useStore = React.useContext(context);\n  if (!useStore) throw `R3F hooks can only be used within the Canvas component!`;\n  return useStore(selector, equalityFn);\n}\nfunction useFrame(callback, renderPriority = 0) {\n  const {\n    subscribe\n  } = React.useContext(context).getState().internal; // Update ref\n\n  const ref = React.useRef(callback);\n  React.useLayoutEffect(() => void (ref.current = callback), [callback]); // Subscribe/unsub\n\n  React.useLayoutEffect(() => {\n    const unsubscribe = subscribe(ref, renderPriority);\n    return () => unsubscribe();\n  }, [renderPriority, subscribe]);\n  return null;\n}\n\nfunction buildGraph(object) {\n  const data = {\n    nodes: {},\n    materials: {}\n  };\n\n  if (object) {\n    object.traverse(obj => {\n      if (obj.name) {\n        data.nodes[obj.name] = obj;\n      }\n\n      if (obj.material && !data.materials[obj.material.name]) {\n        data.materials[obj.material.name] = obj.material;\n      }\n    });\n  }\n\n  return data;\n}\n\nfunction useGraph(object) {\n  return React.useMemo(() => buildGraph(object), [object]);\n}\n\nfunction loadingFn(extensions, onProgress) {\n  return function (Proto, ...input) {\n    // Construct new loader and run extensions\n    const loader = new Proto();\n    if (extensions) extensions(loader); // Go through the urls and load them\n\n    return Promise.all(input.map(input => new Promise((res, reject) => loader.load(input, data => {\n      if (data.scene) Object.assign(data, buildGraph(data.scene));\n      res(data);\n    }, onProgress, error => reject(`Could not load ${input}: ${error.message}`)))));\n  };\n}\n\nfunction useLoader(Proto, input, extensions, onProgress) {\n  // Use suspense to load async assets\n  const keys = Array.isArray(input) ? input : [input];\n  const results = useAsset(loadingFn(extensions, onProgress), Proto, ...keys); // Return the object/s\n\n  return Array.isArray(input) ? results : results[0];\n}\n\nuseLoader.preload = function (Proto, input, extensions) {\n  const keys = Array.isArray(input) ? input : [input];\n  return useAsset.preload(loadingFn(extensions), Proto, ...keys);\n};\n\nconst roots = new Map();\nconst modes = ['legacy', 'blocking', 'concurrent'];\nconst {\n  invalidate,\n  advance\n} = createLoop(roots);\nconst {\n  reconciler,\n  applyProps\n} = createRenderer();\n\nconst createRendererInstance = (gl, canvas) => isRenderer(gl) ? gl : new THREE.WebGLRenderer({\n  powerPreference: 'high-performance',\n  canvas: canvas,\n  antialias: true,\n  alpha: true,\n  ...gl\n});\n\nfunction render(element, canvas, {\n  gl,\n  size,\n  mode = modes[1],\n  events,\n  onCreated,\n  ...props\n} = {}) {\n  var _store;\n\n  // Allow size to take on container bounds initially\n  if (!size) {\n    var _canvas$parentElement, _canvas$parentElement2, _canvas$parentElement3, _canvas$parentElement4;\n\n    size = {\n      width: (_canvas$parentElement = (_canvas$parentElement2 = canvas.parentElement) == null ? void 0 : _canvas$parentElement2.clientWidth) != null ? _canvas$parentElement : 0,\n      height: (_canvas$parentElement3 = (_canvas$parentElement4 = canvas.parentElement) == null ? void 0 : _canvas$parentElement4.clientHeight) != null ? _canvas$parentElement3 : 0\n    };\n  }\n\n  let root = roots.get(canvas);\n  let fiber = root == null ? void 0 : root.fiber;\n  let store = root == null ? void 0 : root.store;\n  let state = (_store = store) == null ? void 0 : _store.getState();\n\n  if (fiber && state) {\n    const lastProps = state.internal.lastProps; // When a root was found, see if any fundamental props must be changed or exchanged\n    // Check pixelratio\n\n    if (props.dpr !== undefined && !is.equ(lastProps.dpr, props.dpr)) state.setDpr(props.dpr); // Check size\n\n    if (size !== undefined && !is.equ(lastProps.size, size)) state.setSize(size.width, size.height); // For some props we want to reset the entire root\n    // Changes to the color-space\n\n    const linearChanged = props.linear !== lastProps.linear;\n\n    if (linearChanged) {\n      unmountComponentAtNode(canvas);\n      fiber = undefined;\n    }\n  }\n\n  if (!fiber) {\n    // If no root has been found, make one\n    // Create gl\n    const glRenderer = createRendererInstance(gl, canvas); // Enable VR if requested\n\n    if (props.vr) {\n      glRenderer.xr.enabled = true;\n      glRenderer.setAnimationLoop(timestamp => advance(timestamp, true));\n    } // Create store\n\n\n    store = createStore(applyProps, invalidate, advance, {\n      gl: glRenderer,\n      size,\n      ...props\n    });\n    const state = store.getState();\n    state.get; // Create renderer\n\n    fiber = reconciler.createContainer(store, modes.indexOf(mode), false, null); // Map it\n\n    roots.set(canvas, {\n      fiber,\n      store\n    }); // Store events internally\n\n    if (events) state.set({\n      events: events(store)\n    });\n  }\n\n  if (store && fiber) {\n    reconciler.updateContainer( /*#__PURE__*/React.createElement(Provider, {\n      store: store,\n      element: element,\n      onCreated: onCreated,\n      target: canvas\n    }), fiber, null, () => undefined);\n    return store;\n  } else {\n    throw 'Error creating root!';\n  }\n}\n\nfunction Provider({\n  store,\n  element,\n  onCreated,\n  target\n}) {\n  React.useEffect(() => {\n    const state = store.getState(); // Flag the canvas active, rendering will now begin\n\n    state.set(state => ({\n      internal: { ...state.internal,\n        active: true\n      }\n    })); // Connect events\n\n    state.events.connect == null ? void 0 : state.events.connect(target); // Notifiy that init is completed, the scene graph exists, but nothing has yet rendered\n\n    if (onCreated) onCreated(state);\n  }, []);\n  return /*#__PURE__*/React.createElement(context.Provider, {\n    value: store\n  }, element);\n}\n\nfunction unmountComponentAtNode(canvas, callback) {\n  const root = roots.get(canvas);\n  const fiber = root == null ? void 0 : root.fiber;\n\n  if (fiber) {\n    const state = root == null ? void 0 : root.store.getState();\n    if (state) state.internal.active = false;\n    reconciler.updateContainer(null, fiber, null, () => {\n      if (state) {\n        setTimeout(() => {\n          var _state$gl, _state$gl$renderLists, _state$gl2;\n\n          state.events.disconnect == null ? void 0 : state.events.disconnect();\n          (_state$gl = state.gl) == null ? void 0 : (_state$gl$renderLists = _state$gl.renderLists) == null ? void 0 : _state$gl$renderLists.dispose == null ? void 0 : _state$gl$renderLists.dispose();\n          (_state$gl2 = state.gl) == null ? void 0 : _state$gl2.forceContextLoss == null ? void 0 : _state$gl2.forceContextLoss();\n          dispose(state);\n          roots.delete(canvas);\n          if (callback) callback(canvas);\n        }, 500);\n      }\n    });\n  }\n}\n\nfunction dispose(obj) {\n  if (obj.dispose && obj.type !== 'Scene') obj.dispose();\n\n  for (const p in obj) {\n    var _dispose, _ref;\n    (_dispose = (_ref = p).dispose) == null ? void 0 : _dispose.call(_ref);\n    delete obj[p];\n  }\n}\n\nconst act = reconciler.act;\nconst hasSymbol = is.fun(Symbol) && Symbol.for;\nconst REACT_PORTAL_TYPE = hasSymbol ? Symbol.for('react.portal') : 0xeaca;\n\nfunction createPortal(children, container, implementation, key = null) {\n  return {\n    $$typeof: REACT_PORTAL_TYPE,\n    key: key == null ? null : '' + key,\n    children,\n    containerInfo: prepare(container),\n    implementation\n  };\n}\n\nreconciler.injectIntoDevTools({\n  bundleType: process.env.NODE_ENV === 'production' ? 0 : 1,\n  rendererPackageName: '@react-three/fiber',\n  version: '17.0.2'\n});\n\nexport { Canvas, threeTypes as ReactThreeFiber, roots as _roots, act, addAfterEffect, addEffect, addTail, advance, applyProps, context, createPortal, dispose, createPointerEvents as events, extend, invalidate, reconciler, render, unmountComponentAtNode, useFrame, useGraph, useLoader, useThree };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}